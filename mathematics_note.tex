\documentclass[a4paper,11pt]{ltjsarticle}

% パッケージの読み込み
\usepackage{luatexja}
\usepackage{luatexja-fontspec}
\usepackage{auxhook}
\usepackage{graphicx}
\usepackage{adjustbox}
\usepackage{etoc} % etocパッケージを追加

% 日本語フォントの手動設定
\setmainjfont[
    YokoFeatures={JFM=jlreq},
    TateFeatures={JFM=jlreqv},
    BoldFont={Hiragino Kaku Gothic ProN W6}, % 太さを具体的に指定
]{Hiragino Mincho ProN}

\setsansjfont[
    YokoFeatures={JFM=jlreq},
    TateFeatures={JFM=jlreqv},
    BoldFont={Hiragino Kaku Gothic ProN W6}, % 太さを具体的に指定
]{Hiragino Kaku Gothic ProN}

% 英文フォントの設定
\setmainfont{Latin Modern Roman}[%
    BoldFont=lmroman10-bold,%
    BoldItalicFont=lmroman10-bolditalic,%
    ItalicFont=lmromanslant10-regular,%
    SmallCapsFont=lmromancaps10-regular,%
    SlantedFont=lmromanslant10-regular,%
    FontFace={sb}{n}{lmromandemi10-regular},%
    OpticalSize=0
]
\setsansfont{Latin Modern Sans}[%
    BoldFont=lmsans10-bold,%
    ItalicFont=lmsans10-oblique%
]
\setmonofont{Latin Modern Mono}[%
    BoldFont=lmmonolt10-bold,%
    ItalicFont=lmmono10-italic%
]

\renewcommand{\emph}[1]{\textbf{#1}}

% 数学パッケージの読み込み
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{bm}
\usepackage{ascmac}

% ヘッダーフォントの設定
\renewcommand{\headfont}{\sffamily\bfseries}

% 括弧
\usepackage{delimseasy}

% 二段組
\usepackage{multicol}
\setlength{\columnseprule}{.5pt} % 中央の線

% 見出しのフォント
\renewcommand{\headfont}{\sffamily\bfseries}


%biblatex
\usepackage[style=numeric,sorting=none,hyperref=auto]{biblatex}
\DeclareNameAlias{default}{family-given}
\renewcommand*{\revsdnamepunct}{\addspace}
\DeclareDelimFormat{nametitledelim}{\addspace} % 名前とタイトルの間のデリミタをスペースに変更

%連名
\DeclareDelimFormat{multinamedelim}{\addcomma\space}
\DeclareDelimFormat{finalnamedelim}{\space and\space}
\DeclareDelimFormat{andothersdelim}{\space and\space}


\DeclareFieldFormat[book]{title}{\normalfont{#1}} % 本のタイトルを通常のフォントで表示
\addbibresource{bibliography.bib}

% 章の設定
\usepackage{titlesec}
\usepackage{picture}

\usepackage{xcolor}
% colors
\definecolor{myblue}{HTML}{3300CC}
\definecolor{myred}{HTML}{CC33CC}
\definecolor{mypink}{HTML}{FF66FF}
\definecolor{mygreen}{HTML}{005500}
\definecolor{mynamecolor}{HTML}{5507FF}
\definecolor{myemailcolor}{HTML}{FF4F02}
\definecolor{darkbrown}{HTML}{880000}
\definecolor{dred}{HTML}{DD0000}
\definecolor{dgreen}{HTML}{005500}
\definecolor{dblue}{HTML}{000088}
\definecolor{mypurple}{HTML}{ba55d3} % 追加
\definecolor{burgundy}{rgb}{0.5, 0.0, 0.13}
\definecolor{charcoal}{rgb}{0.21, 0.27, 0.31}
\colorlet{lightmypurple}{mypurple!20!white}


% --- Base (Neutrals) ---
\definecolor{applePaper}{HTML}{F5F5F7} % ペーパー/セクション背景（明るい灰）
\definecolor{appleCard} {HTML}{FFFFFF} % 白カード
\definecolor{appleInk}  {HTML}{1D1D1F} % 本文インク（ほぼ黒）
\definecolor{appleInkGray}{HTML}{37373A} % Ink寄りのダークグレイ（要求により必須）
\definecolor{appleLine} {HTML}{D2D2D7} % 区切り線（Appleの薄い線）
\definecolor{appleGrayLight}{HTML}{E5E5EA} % 薄い灰（背景の差別化）
\definecolor{appleGray}     {HTML}{8E8E93} % 中間灰（注釈や副次情報）
\definecolor{appleGrayDark} {HTML}{3A3A3C} % 濃い灰（強めのUI線）
\definecolor{appleBlack}    {HTML}{1D1D1F} % 黒系のエイリアス

% --- Accents (Blue / Indigo / Purple / Magenta) ---
\definecolor{appleBlue600}{HTML}{0071E3} % Appleのボタン系ブルー
\definecolor{appleBlue500}{HTML}{0A84FF} % iOS System Blue
\definecolor{appleBlue300}{HTML}{64D2FF} % 薄いブルー（図形の塗りやハイライト）
\definecolor{appleIndigo}  {HTML}{5E5CE6} % iOS System Indigo
\definecolor{applePurple}  {HTML}{BF5AF2} % iOS System Purple（鮮やかな紫）
\definecolor{applePurpleDark}{HTML}{8E43E7} % 濃い紫（強調用）
\definecolor{appleMagenta} {HTML}{D6006D} % 赤紫（強調・リンク代替）
\definecolor{applePink}    {HTML}{FF2D55} % ピンク寄り赤紫（軽いアクセント）
\definecolor{appleOrange}  {HTML}{C76A00} % Dark Amber（白地でも視認性◎）
\definecolor{appleRed}     {HTML}{C92A2A} % Dark Red（物理の強調・白地でも視認性◎）


% --- 既存色名 → Apple調へのエイリアス（既存TikZコード互換） ---
\colorlet{Ink}{appleInk}                   % 既存 'Ink' を本文インクに
\colorlet{darkgray2}{appleGrayLight}       % 既存 'darkgray2' を薄い灰に
\colorlet{appleBlue}{appleBlue600}         % 後方互換のため残す（定義名そのまま）
\colorlet{appleLineDark}{appleGrayDark}    % 濃い線を統一

% --- ドキュメントで参照される補助色（必要なら継続使用） ---
\definecolor{appleTitleGray}{RGB}{86,86,91}
\definecolor{appleLineGray}{RGB}{134,134,139}

% --- 上下和（ハッチ/塗り） ---
\definecolor{CupertinoBlue}{HTML}{0A84FF}   % System Blue
\definecolor{CupertinoIndigo}{HTML}{5E5CE6} % System Indigo
\colorlet{upperfill}{CupertinoBlue!28}
\colorlet{lowerfill}{CupertinoIndigo!28}
% ---- モノトーンのタグ色 ----
\colorlet{SectionTag}{appleGrayDark}
\colorlet{SubsectionTag}{appleGray}
\colorlet{SubsubsectionTag}{appleInkGray}
% ---- 行の高さに自動追従する左肩の細四角 ----
\newcommand{\TitleSquareToText}[2][1.05ex]{%
  \begingroup
    \leavevmode
    \setbox0=\hbox{\strut}%
    \textcolor{#2}{\rule[-\dp\strutbox]{#1}{\dimexpr\ht\strutbox+\dp\strutbox\relax}}%
  \endgroup
}

% ---------------- Part（下線=フル幅） ----------------
\titleformat{\part}[display]
  {\normalfont\LARGE\bfseries\centering\color{appleInk}}
  {\small\scshape\color{appleGray}\partname~\thepart}
  {0.3ex}
  {}%
  [{%
     \vspace{0.6ex}%
     \noindent{\color{appleLine}\rule{\linewidth}{1.2pt}}%
     \nobreak\vspace{0.25ex}%
     \noindent{\color{appleLine}\rule{\linewidth}{0.6pt}}%
  }]
% ---------------- Section（下線=66%） ----------------
\titleformat{\section}[block]
  {\normalfont\Large\bfseries\color{appleInk}}
  {}{0pt}
  {%
    \TitleSquareToText[1.05ex]{SectionTag}\hspace{0.6em}%
    \thesection\quad
  }%
  [{%
     \vspace*{-0.48\baselineskip}% ← 線を上に引き上げて詰める
     \noindent{\color{appleLine}\rule{0.66\linewidth}{0.8pt}}%
     \nobreak\vspace{-0.10\baselineskip}% ← 線の下側（本文との距離）
  }]

% ---------------- Subsection（下線=50%） ----------------
\titleformat{\subsection}[block]
  {\normalfont\large\bfseries\color{appleInk}}
  {}{0pt}
  {%
    \TitleSquareToText[0.95ex]{SubsectionTag}\hspace{0.55em}%
    \thesubsection\quad
  }%
  [{%
     \vspace*{-0.52\baselineskip}% ← もう少しだけ控えめに詰める
     \noindent{\color{appleLine}\rule{0.50\linewidth}{0.6pt}}%
     \nobreak\vspace{-0.18\baselineskip}%
  }]

% ---------------- Subsubsection（下線=42%） ----------------
\titleformat{\subsubsection}[block]
  {\normalfont\large\bfseries\color{appleInk}}
  {}{0pt}
  {%
    \TitleSquareToText[0.90ex]{SubsubsectionTag}\hspace{0.50em}%
    \thesubsubsection\quad
  }%
  [{%
     \vspace*{-0.40\baselineskip}% ← さらに控えめ
     \noindent{\color{appleLine}\rule{0.42\linewidth}{0.5pt}}%
     \nobreak\vspace{-0.16\baselineskip}%
  }]


% 数式
\usepackage{nccmath}
\usepackage{mathtools}
\usepackage{empheq} % 数式の囲いに使う
\usepackage[bbsets]{jkmath} % \Nなどをつかえる
\usepackage{color}

% 箇条書き
\usepackage[shortlabels,inline]{enumitem}
\setlist[description]{font={\bfseries\sffamily}}

% まわりこみ
\usepackage{wrapfig}


% ハイパーリンク用
\usepackage{url}
\usepackage{hyperref}
\hypersetup{colorlinks=true,citecolor={mypurple!40!black},linkcolor={mypurple!40!black},urlcolor={mypurple!70!black},}
\usepackage[numbered]{bookmark}

% tcolorbox系
\usepackage[many]{tcolorbox}
\tcbuselibrary{breakable,skins,theorems,xparse,hooks}
\newtcolorbox{hosoibox}[1]{colframe=black,colback=white,coltitle=black,colbacktitle=white,boxrule=0.5pt,arc=0mm,enhanced,attach boxed title to top left={xshift=10mm,yshift=-3mm},boxed title style={frame hidden},title=#1}
\usepackage{lipsum}

%leftbar環境に注釈が入れられないことを解消する環境．名前は，tcolorboxの[t]とleftbarの組み合わせ
\newtcolorbox{tbleftline}{blanker,breakable,left=5mm,borderline west={1.1mm}{0pt}{black}}
\newenvironment{tleftbar}{\begin{tbleftline}\setlength{\parindent}{1\zw}}{\end{tbleftline}}

%dotleftbar環境
\newtcolorbox{tbdotleftline}{%
  blanker, left=5mm,breakable,
  borderline west={1.1mm}{0pt}{draw=black, dotted}
}
\newenvironment{dotleftbar}{%
  \begin{tbdotleftline}\setlength{\parindent}{1\zw}%
}{%
  \end{tbdotleftline}%
}
% 必要パッケージ
% \usepackage[most]{tcolorbox}   % 既に読み込み済みなら不要
% \tcbuselibrary{skins,breakable}

% ------------------------------------------------
% Apple調の落ち着いた共通ベース
% ------------------------------------------------
% color_style.tex にある想定色（例）:
% appleCard, applePaper, appleInk, appleInkGray, appleGrayLight, appleGray, appleGrayDark, applePurple
% ※ applePurple が無ければ、appleInkGray へ一時的に差し替えて OK

% アクセント用の色エイリアス（ここだけ触れば配色一括変更できます）
\colorlet{acc@th}{appleInkGray}                 % Theorem：最もニュートラル
\colorlet{acc@pr}{appleGrayDark}                % Proposition：やや濃い灰
\colorlet{acc@co}{appleGray}                    % Corollary：中間灰
\colorlet{acc@ax}{appleInk}                     % Axiom：ほぼ黒（最も重い主張）
\colorlet{acc@de}{applePurple}                  % Definition：紫（主張はするが落ち着き）
\colorlet{acc@le}{applePurple!75!appleInk}      % Lemma：定義より少し落ち着いた紫
\colorlet{acc@ex}{appleGrayLight}               % Example：軽めの灰（導入・補助）
\colorlet{acc@qu}{applePurple!60!appleGray}     % Question：紫寄り灰

% 共通ベース：白カード＋左2ptアクセント＋下端0.8ptの薄線
\tcbset{
  theo-base/.style={
    enhanced, breakable, sharp corners,
    boxrule=0pt, no shadow,
    colback=appleCard, colframe=appleCard, colbacktitle=appleCard,
    coltitle=appleInk, coltext=appleInk,
    fonttitle=\gtfamily\sffamily\bfseries\upshape,
    left*=1\zw, right*=1\zw, top=8pt, bottom=10pt,
    borderline south={0.8pt}{-2pt}{appleLine}, % 「箱のすぐ下」に薄い仕切り線
    before skip=16pt, after skip=18pt,
    before upper={\setlength{\parindent}{1\zw}},
    before lower={\setlength{\parindent}{1\zw}}
  },
  % 1 引数: アクセント色
  mytheo/.style n args={1}{
    theo-base,
    borderline west={2pt}{0pt}{#1} % 左に2ptのアクセントバー
  },
}

% ------------------------------------------------
% 環境定義（番号は subsection 内で進む）
% ------------------------------------------------
\newtcbtheorem[number within=subsection]{theorem}{Theorem}%
{mytheo={acc@th}}{th}
\newcommand{\thref}[1]{\textsf{\bfseries Theorem~\ref{th:#1}}}

\newtcbtheorem[use counter from=theorem]{prop}{Proposition}%
{mytheo={acc@pr}}{pr}
\newcommand{\prref}[1]{\textsf{\bfseries Proposition~\ref{pr:#1}}}

\newtcbtheorem[use counter from=theorem]{cor}{Corollary}%
{mytheo={acc@co}}{co}
\newcommand{\coref}[1]{\textsf{\bfseries Corollary~\ref{co:#1}}}

\newtcbtheorem[use counter from=theorem]{axiom}{Axiom}%
{mytheo={acc@ax}}{ax}
\newcommand{\axref}[1]{\textsf{\bfseries Axiom~\ref{ax:#1}}}

\newtcbtheorem[use counter from=theorem]{definition}{Definition}%
{mytheo={acc@de}}{de}
\newcommand{\deref}[1]{\textsf{\bfseries Definition~\ref{de:#1}}}

\newtcbtheorem[use counter from=theorem]{lemma}{Lemma}%
{mytheo={acc@le}}{le}
\newcommand{\lemref}[1]{\textsf{\bfseries Lemma~\ref{le:#1}}}
% 互換：もし既存で \leqqref を使っていたら壊さないように
\providecommand{\leqqref}[1]{\lemref{#1}}

\newtcbtheorem[use counter from=theorem]{example}{Example}%
{mytheo={acc@ex}}{ex}
\newcommand{\exref}[1]{\textsf{\bfseries Example~\ref{ex:#1}}}

\newtcbtheorem[use counter from=theorem]{question}{Question}%
{mytheo={acc@qu}}{qu}
\newcommand{\quref}[1]{\textsf{\bfseries Question~\ref{qu:#1}}}

% その他の設定
% 囲い枠
\DeclareTColorBox{simplesquarebox}{ o m O{.5} O{} }% 
    {empty, left=2mm, right=2mm, top=-1mm, attach boxed title to top left={xshift=1.2\zw},
    boxed title style={empty,left=-2mm,right=-2mm}, colframe=black, coltitle=black, coltext=black, breakable,  
    underlay unbroken={\draw[black,line width=#3pt]
        (title.east) -- (title.east-|frame.east) -- (frame.south east) -- (frame.south west) -- (title.west-|frame.west) -- (title.west); },
    underlay first={\draw[black,line width=#3pt](title.east) -- (title.east-|frame.east) -- (frame.south east) ;
        \draw[black,line width=#3pt] (frame.south west) -- (title.west-|frame.west) -- (title.west); },
    underlay middle={\draw[black,line width=#3pt](frame.north east) -- (frame.south east) ;
        \draw[black,line width=#3pt](frame.south west) -- (frame.north west) ;},
    underlay last={\draw[black,line width=#3pt](frame.north east) -- (frame.south east) -- (frame.south west) -- (frame.north west) ;},
    fonttitle=\gtfamily, IfValueTF={#1}{title=【#2】〈#1〉}{title=【#2】},#4}


    \colorlet{colexam}{red!75!black}
    
    \newtcolorbox[auto counter,number format=\Roman]{mycolumn}{
      empty,
      title={\bfseries\sffamily Column \thetcbcounter}, % カウンタをローマ数字で表示
      attach boxed title to top left,
      boxed title style={
        empty,
        size=minimal,
        toprule=2pt,
        top=4pt,
        left=1cm, % タイトルを右に移動
        overlay={
          % タイトルの上の線を削除
          % \draw[colexam,line width=2pt]
          %   ([yshift=-1pt]frame.north west) -- ([yshift=-1pt]frame.north east);
        }
      },
      coltitle=colexam,
      fonttitle=\Large\bfseries,
      before=\par\medskip\noindent,
      parbox=false,
      boxsep=0pt,
      left=5mm, % 左のマージンを増やしてタイトルを右に移動
      right=3mm,
      top=4pt,
      breakable,
      pad at break*=0mm,
      vfill before first,
      overlay unbroken={
        \draw[colexam,line width=2pt]
          ([xshift=-0.5pt,yshift=10pt]frame.north east)
          -- ([xshift=-0.5pt]frame.south east);
        \draw[colexam,line width=2pt]
          ([xshift=-1pt,yshift=10pt]frame.north west)
          -- ([xshift=-1pt]frame.south west);
      },
      overlay first={
        \draw[colexam,line width=2pt]
          ([xshift=-0.5pt,yshift=10pt]frame.north east)
          -- ([xshift=-0.5pt]frame.south east);
        \draw[colexam,line width=2pt]
          ([xshift=-1pt,yshift=10pt]frame.north west)
          -- ([xshift=-1pt]frame.south west);
      },
      overlay middle={
        \draw[colexam,line width=2pt]
          ([xshift=-0.5pt,yshift=10pt]frame.north east)
          -- ([xshift=-0.5pt]frame.south east);
        \draw[colexam,line width=2pt]
          ([xshift=-1pt,yshift=10pt]frame.north west)
          -- ([xshift=-1pt]frame.south west);
      },
      overlay last={
        \draw[colexam,line width=2pt]
          ([xshift=-0.5pt,yshift=10pt]frame.north east)
          -- ([xshift=-0.5pt]frame.south east);
        \draw[colexam,line width=2pt]
          ([xshift=-1pt,yshift=10pt]frame.north west)
          -- ([xshift=-1pt]frame.south west);
      },%
    }
    
    


% 例題環境
\newcounter{mondaibangou}
\newtcolorbox{mondai}[1][]{enhanced,boxrule=0.5mm,
        top=2pt,left=44pt,right=4pt,bottom=2pt,arc=0mm,
        colframe=blue!30!gray,
        boxrule=1pt,
        underlay={
        \node[inner sep=1pt,blue!50!black,fill=blue!10!white]at ([xshift=22pt,yshift=-9pt]interior.north west) {\stepcounter{mondaibangou}\bfseries\gtfamily 問題\themondaibangou};},
        segmentation code={%
        \draw[dashed] (segmentation.west)--(segmentation.east);
        \node[inner sep=1pt,blue!50!black,fill=blue!10!white] at ([xshift=22pt,yshift=-8pt]segmentation.south west) {\bfseries\gtfamily 解答};},
        before upper={\setlength{\parindent}{1\zw}},
        before lower={\setlength{\parindent}{1\zw}},#1
}

% 感想環境
\DeclareTColorBox{kans}{ o m O{3} O{}}%
{enhanced, colback=white, colframe=white,
attach boxed title to top left={xshift=1cm,yshift=-\tcboxedtitleheight/2}, fonttitle=\bfseries,varwidth boxed title=0.85\linewidth, coltitle=black, fonttitle=\gtfamily, 
enlarge top by=2mm, enlarge bottom by=2mm, breakable, sharp corners,
boxed title style={colback=white,left=0mm,right=0mm}, 
borderline={.75pt}{#3pt}{black,dotted},
% underlay settings...
IfValueTF={#1}{title=【#2】〈#1〉}{title=【#2】},#4}

\usepackage{framed,color}

%索引
\usepackage{makeidx}
\makeindex

% 題名付き四角
\usepackage{ascmac}
\usepackage{fancybox}

% 図に使うもの
\usepackage{tikz}
\usetikzlibrary{intersections,calc,arrows.meta,calendar,shadows.blur}
\usepackage{tikz-3dplot}
\usepackage[marginparwidth=0pt,margin=15truemm]{geometry}
\usepackage{bxpapersize}
\usepackage[absolute,overlay]{textpos} % 図の配置を好きにする

\usepackage{pgfplots}
\usepgfplotslibrary{fillbetween}
\pgfplotsset{compat=1.17}

% footnoteの変更
\renewcommand\thefootnote{{\dag}\arabic{footnote}}
\renewcommand{\thempfootnote}{{\dag}\arabic{mpfootnote}}
\interfootnotelinepenalty=10000

\usepackage{oubraces} % overunderbraces

% underbraceの文字数が多いときのためのadunderbrace
\usepackage{ifthen}
\newlength{\wdTempA}
\newlength{\wdTempB}
\newcommand{\adunderbrace}[2]{%
\settowidth{\wdTempA}{$#1$}%
\settowidth{\wdTempB}{${\scriptstyle #2}$}%
\ifthenelse{\wdTempA<\wdTempB}{%
\hspace*{.5\wdTempA}\hspace*{-.5\wdTempB}%
\underbrace{#1}_{#2}%
\hspace*{.5\wdTempA}\hspace*{-.5\wdTempB}%
}{%
\underbrace{#1}_{#2}%
}%
}%
% 丸付き文字
\newcommand{\ctext}[1]{\raise0.2ex\hbox{\textcircled{\scriptsize{#1}}}}

\setlength{\abovedisplayskip}{5pt} 
\setlength{\belowdisplayskip}{3pt}
% ユーザー定義
\newcommand{\dash}[1]{#1^\prime}
\newcommand{\ddash}[1]{#1^{\prime\prime}}
\newcommand{\dddash}[1]{#1^{\prime\prime\prime}}
\newcommand{\hodash}[2]{#2^{(#1)}}
\renewcommand{\labelenumi}{(\arabic{enumi})}% itemを(数字)に変更
\newcommand{\two}{I\hspace{-1.2pt}I}
\newcommand{\three}{I\hspace{-1.2pt}I\hspace{-1.2pt}I}
\DeclareMathOperator{\Ker}{Ker}
\renewcommand{\proofname}{\textgt{証明}}
\renewcommand{\qed}{\unskip\nobreak\quad\qedsymbol}

\renewcommand{\le}{\leqq}
\renewcommand{\ge}{\geqq}

\renewcommand{\leq}{\leqq}
\renewcommand{\geq}{\geqq}

\newcommand\kakko[1]{\noindent\textbf{《#1》}}

\newcommand{\draftnote}[1]{\begin{center}\textbf{\textcolor{red}{執筆中：~#1}}\end{center}}

\newcommand{\dom}{\mathop{\mathrm{dom}}\nolimits}
\newcommand{\ran}{\mathop{\mathrm{ran}}\nolimits}

\everymath{\displaystyle}

\newcommand{\HRule}[1]{\rule{\linewidth}{#1}}

\AtBeginDocument{\RenewCommandCopy\qty\SI}

% 丸付き文字
\usepackage{docmute}

\everymath{\displaystyle}

% ===================== ToC (etoc) — Apple風見出し =====================
\makeatletter
\AtBeginDocument{%

  % 目次に出す深さ
  \etocsetnexttocdepth{subsubsection}

  % 目次ブロックの前後
  \etocsettocstyle{%
    \par\vspace{10pt}%
    \noindent\hspace*{-\leftskip}%
    \begin{tikzpicture}[x=\linewidth, baseline]
      \draw[line cap=round, line width=0.8pt, color=appleLine] (0,0) -- (1,0);
      \node[inner sep=2.5pt, outer sep=0pt, fill=appleCard] at (0.5,0)
        {\bfseries\Large\textcolor{appleInk}{目\kern0.35em 次}};
        % 背景が白なら fill=white に変更
    \end{tikzpicture}%
    \vspace{8pt}%
  }{%
    \vspace{8pt}%
    \noindent\hspace*{-\leftskip}%
    \begin{tikzpicture}[x=\linewidth, baseline]
      \draw[line cap=round, line width=0.5pt, color=appleLine] (0,0) -- (1,0);
    \end{tikzpicture}%
    \vspace{12pt}%
  }

  % ---- 各レベルの表示 ----
  \etocsetstyle{part}
    {\noindent}
    {%
      \vskip20pt
      \parindent0pt \leftskip0pt
      \etoclink{\bfseries\huge\color{appleInk}\etocname}\par
      \vskip10pt
    }
    {}

  \etocsetstyle{section}
    {\noindent}
    {%
      \vskip10pt
      \parindent0pt \leftskip5pt
      \etoclink{\bfseries\LARGE\color{appleInk}\etocnumber~\etocname}%
      \leaders\hbox to .5em{\hss.\hss}\hfill \etocpage\par
      \vskip10pt
    }
    {}

  \etocsetstyle{subsection}
    {\noindent}
    {%
      \vskip6pt
      \parindent0pt \leftskip25pt % ←調整可（例: 20pt）
      \etoclink{\bfseries\large\textcolor{appleInk}{\etocnumber~\etocname}}%
      \nobreak\leaders\hbox to .5em{\hss.\hss}\hfill \etocpage\par
      \vskip6pt
    }
    {}
}
\makeatother
% ======================================================================



\etocsetstyle{subsubsection}
{\noindent}
{%
  \parindent0pt \leftskip50pt % `subsubsection` は30ptのインデント
  \etoclink{\bfseries\normalsize\color{appleInk}{\etocnumber~\etocname}}%
  \ % 項目の間に半角スペースを挿入
  (p.\etocpage)% ページ番号の表示
  \hspace{1em}
}
{}

% タイトルセクションをロード
\usepackage{titletoc}


% タイトルページを定義
\usepackage{pagecolor} % 背景色を変更するためのパッケージ

\newcommand{\tituloum}[5]{
  \begin{titlepage}
    \begin{center}
        \pagecolor{white} % 背景色を白に設定
        \color{appleInk} % テキストカラーをappleInkに設定
        
        \vspace*{2\baselineskip}

        % 横線の色をappleInkに設定
        \textcolor{appleInk}{\rule{\textwidth}{1.6pt}}\vspace*{-\baselineskip}\vspace*{2pt}
        \textcolor{appleInk}{\rule{\textwidth}{0.4pt}}
        
        \vspace{0.75\baselineskip}
        
        {\huge #1}
        
        \vspace{0.75\baselineskip}

        \textcolor{appleInk}{\rule{\textwidth}{0.4pt}}\vspace*{-\baselineskip}\vspace{3.2pt}
        \textcolor{appleInk}{\rule{\textwidth}{1.6pt}}

        \vspace{2\baselineskip}
        
        #3
        
        \vspace*{3\baselineskip}
        
        {\huge #2}
        
        \vspace{0.5\baselineskip}
        
        \textit{#4}
        
        \vfill
        
        \vspace{0.3\baselineskip}
        
        #5
        
    \end{center}
\end{titlepage}%
}

\setcounter{secnumdepth}{3}

\begin{document}

% タイトルページの呼び出し
\tituloum{数学のノート}{なまちゃん}{}{}{\today}

%\include{Preambulo/Capa}

\thispagestyle{empty}

\newpage
\pagenumbering{arabic}
\pagecolor{white}

% 目次の表示
\localtableofcontents
\newpage


\phantomsection
\part*{数学の基本}
\section{用語の定義}

\phantomsection
\subsection{定義・命題・定理・補題・系}

\phantomsection
\subsubsection{定義}

\emph{定義}\index{ていぎ@定義}（\emph{definition}）とは，用語の意味を明確に述べたものであり，\textbf{Def}と略記される．
数学のお話にうつる前に，日常的な「定義」の例を見てみよう．

\begin{example}{「DNA」の定義}{「DNA」の定義}
  DNAとは，デオキシリボ核酸の略で，生物の遺伝情報を担う分子の一種である．
\end{example}

\begin{example}{「民主主義」の定義}{「民主主義」の定義}
  民主主義とは，国民が政治の意思決定に直接または間接的に参加する政治体制のことをいう．
\end{example}

\begin{example}{遊びの定義}{遊びの定義}
  ホイジンガの遊びの定義は，次の5つのいずれかを満たすものである．
  \begin{enumerate}[(1)]
    \item 自由で強要されない行為
    \item 仮構の世界
    \item 場所的時間的限定性をもつ
    \item 秩序を創造する
    \item 秘密をもつ
  \end{enumerate}
\end{example}

どちらもわかりやすい例であり，「すでに知っていること」と思われる読者もいるかもしれない．
しかし，議論を行う上で，定義が曖昧なままだと不都合が生じることがある．

\begin{example}{曖昧な定義による誤解}{曖昧な定義による誤解}
  ある物体の速度$v$ \footnote{$\vec{v}$や$\bm{v}$と表記することもあるが，大学では，文字を書く際にベクトルとスカラーの表記を区別しない場合が多いので，ここもそれにならう．}は
  \[
    v = \frac{dx}{dt}
  \]
  と定義されるが，ここではこれを「速さ」と混同して使うとする．

  物理学では「速度」は大きさと方向を持つベクトル量であり，「速さ」はその大きさだけを示すスカラー量である．
  実際，この場合の「速さ」を数式で表すと，$v$ではなく$\norm{v}$となる．

  このような違いを明確にしないと，運動の解析において誤った結論を導く可能性がある．
\end{example}

同じ事柄について，2つ以上の定義の形式があることもある．次は数学における例を見てみよう：

\phantomsection
\begin{example}{「絶対値」の定義}{「絶対値」の定義}
  $ x \in \mathbb{R}$に対して，$x$の絶対値を$\abs{x}$とかき，次のように定義する：
  \[
    \abs{x} \coloneqq \max \{ x , -x \} .
  \]
  この定義は以下のような形式で表現してもよい：
  \[
    \abs{x} \coloneqq  \sqrt{x^2}.
  \]
\end{example}

次に，定義の性質についてみていこう．
線型代数の講義で学ぶことであるが，逆行列の定義は以下のようになる：

\phantomsection
\begin{example}{「逆行列」の定義}{「逆行列」の定義}
  正方行列$A$に対して，$BA = AB =E$となるような$B$が存在するとき，このような$B$を$A$の逆行列という．
\end{example}


ここで注意するのは \emph{数学では定義は最小限の情報にとどめることが慣習となっている}ということである．たとえば，\exref{「逆行列」の定義}から，以下の命題\footnote{「命題」については，のちほど詳しくみていくとする．ここでは「証明を与えるべきである主張」という理解でよい．}が成り立ち，その証明は容易である．

\phantomsection
\begin{prop}{逆行列の一意性}{逆行列の一意性}
  正方行列$A$に対して，$A$の逆行列は存在するとすればただひとつである．
\end{prop}

\begin{tleftbar}
  \begin{proof}
    $A$の逆行列が$B$，$C$であるとすると，
    \[
      AB=BA=E,\quad AC=CA=E
    \]
    が成り立つ．このとき，
    \[
      B=BE=B(AC)=(BA)C=EC=C
    \]
    が成り立つ．よって，$B=C$であり，逆行列の一意性が示された．
  \end{proof}
\end{tleftbar}

このことから，\exref{「逆行列」の定義}でとりあげた逆行列の定義をもっと詳しく

\begin{quote}
  正方行列$A$に対して，$BA = AB =E$となるような$B$が存在するとき，このような$B$はただひとつで，$B$を$A$の逆行列という．
  $B$は一意に存在するので，これを$A^{-1}$と記す\footnote{一意に存在することがわかっていないと，$A^{-1}$のような記法で表すことはためらわれる．}．もちろん
  \[
    AA^{-1}=A^{-1}A=E.
  \]
\end{quote}
と，「逆行列の一意性を定義に含めてもいいのではないか．」と主張する人がいるかもしれない．
ただ，数学では「定義は最小限の情報にとどめ，そこから導かれる主張を命題として証明する」という慣習があり，
なにが「定義」で，なにが「証明すべきこと」であるかはっきりさせることが多い\footnote{ただ，実際はここで取り上げた逆行列の定義も情報過多である．線型代数で学ぶことになるが，$AB=E$と$BA=E$のどちらか片方の式のみで定義してよいからである．}．

\phantomsection
\subsubsection{命題}

\emph{命題}\index{めいだい@命題}（\emph{proposition}）とは，真偽が定まっている文を指す\footnote{命題はふたつの意味があり，ここでいう命題は「定理・命題・補題」などと並列して表記される「狭い意味での命題」というよりかは「真偽が決まっている文」というニュアンスを持つ「広い意味での命題」である．「狭い意味での命題」は正しい主張である．
  たとえば，「$3$以上の自然数$n$に対して$x^n + y^n =z^n$は自然数解を持たない」という「フェルマーの最終定理」は，
  アンドリュー・ワイルズが証明するまでは「真偽が決まっているがどちらかはわからない」という「広い意味での命題」であったが，
  証明されたのちに「広い意味での命題」であると同時に「狭い意味での命題」にもなった．}．\textbf{Prop}と略記される．
このような論理体系を\emph{二値論理}\index{にちろんり@二値論理}という．
二値論理においては，命題は「真」か「偽」のどちらかあり，命題が真であることを$\mathrm{T}$，偽であることを$\mathrm{F}$と表す．

中間として扱われる主張には
\begin{enumerate}[(1)]
  \item 定義が曖昧なもの \label{enu:定義が曖昧なもの}
  \item 意味が曖昧なもの \label{enu:意味が曖昧なもの}
  \item パラドックス \label{enu:パラドックス}
\end{enumerate}
などがある．\ref{enu:定義が曖昧なもの}，\ref{enu:意味が曖昧なもの}についてはのちほど説明するとして，ここでは\ref{enu:パラドックス}について例をあげよう．

\phantomsection
\begin{example}{自己言及のパラドックス}{自己言及のパラドックス}
  次のような主張を考える：
  \begin{quote}
    この文は偽である．
  \end{quote}
  この主張は，自己言及のパラドックスであり，真偽が決まらない．

  以下も自己言及のパラドックスの例である：
  \begin{quote}
    「この壁に貼り紙をしてはならない」と書かれた貼り紙
  \end{quote}
\end{example}

ここまでで，二値論理でとりあげない主張を述べてきたが，そろそろ二値論理で取り扱う主張のお話に戻ろう．
また，以下では簡単のために，「広い意味での命題」と「狭い意味での命題」のどちらも「命題」と記すと約束する．

\phantomsection
\begin{example}{命題}{命題}
  次に示す文は真偽が真の命題である．
  \begin{enumerate}[(1)]
    \item 「1+1=2」
    \item 「 23 > 17」
    \item 「円周率は100未満である」
    \item 「霞ヶ浦は日本で二番目に面積が大きい湖である」
  \end{enumerate}
  また，次に示す文は真偽が偽の命題である．
  \begin{enumerate}[(a)]
    \item 「1+1=46」
    \item 「23>26」
    \item 「円周率は3未満である」
    \item 「霞ヶ浦は日本で五番目に面積が大きい湖である」
  \end{enumerate}
\end{example}

\phantomsection
\begin{example}{命題でない文}{命題でない文}
  次に示す文は命題ではない
  \begin{enumerate}[(A)]
    \item 「$1+1$」（なにも主張しておらず，真か偽か判定できない）
    \item 「霞ヶ浦の面積は大きい」（客観的に大きいか判定できない）
    \item 「桃はおいしい」（基準が明確でなく，客観的に真か偽か判定できない）
    \item 「$x^2 > 4$」（$x$に具体的な値を代入しないと真か偽か判定できない）\label{enu:命題でない文4}
  \end{enumerate}
\end{example}

\phantomsection
\subsubsection{定理}

\emph{定理}\index{ていり@定理}（\emph{theorem}）とは，正しいと分かっている数学の主張\footnote{つまり，「狭い意味での命題」のこと．}の中でもとりわけ重要なものを指す．\textbf{Thm}と略記される．


定理は数学における真理であり，新たな理論の構築や他の結果の証明の基礎となる．定理は厳密な論理的推論と証明によって裏付けられており，その証明は既知の定理，定義，公理，または論理的推論規則に基づいて行われる．

定理が重要な主張であるがゆえに，「余弦定理」・「加法定理」・「ハイネ・ボレルの被覆定理」など，固有の名前が与えられているものも存在する．
その固有の名前は，定理の主張の詳細，もしくは発見者の名前ににちなんで付けられることが多い．例えば，「三平方の定理」や「コーシー・シュワルツの不等式」である．

\phantomsection
\begin{example}{三平方の定理}{三平方の定理}
  三平方の定理の主張は以下のようになる：
  \begin{quotation}
    直角三角形の斜辺の長さを$c$とし，他の二辺の長さを$a$，$b$としたとき，
    \[
      a^2+b^2=c^2
    \]
    が成り立つ．
  \end{quotation}
\end{example}

\phantomsection
\begin{example}{コーシー・シュワルツの不等式}{コーシー・シュワルツの不等式}
  コーシー・シュワルツの不等式は，内積空間における基本的な不等式であり，以下のように表される：
  \begin{quotation}
    任意の内積空間において，ベクトル$u$と$v$に対して，
    \[
      \norm{\langle u, v \rangle} \leq \norm{u} \cdot \norm{v}
    \]
    が成り立つ．
  \end{quotation}
  この不等式は解析学や線型代数学など，多くの分野で重要な役割を果たす．
\end{example}

\phantomsection
\begin{example}{微分積分学の基本定理}{微分積分学の基本定理}
  この定理は微分と積分の関係を明らかにするものであり，以下のように述べられる：
  \begin{quotation}
    $f$を区間$[a, b]$上で連続な実数値関数とする．このとき，
    \[
      F(x) = \int_a^x f(t) \, dt
    \]
    と定義すると，$F$は$[a, b]$上で微分可能であり，
    \[
      F'(x) = f(x)
    \]
    が成り立つ．
  \end{quotation}
  この定理により，積分と微分が互いに逆操作であることが示される．
\end{example}
\phantomsection
\subsubsection{補題・系}

\emph{補題}\index{ほだい@補題}（\emph{lemma}）とは，定理や命題を証明する際に，その証明の一部として利用される補助的な命題のことを指す．\textbf{Lem}と略記される．補題は，直接的に重要な結果でない場合もあるが，より複雑な定理を証明するための重要なステップとなる主張である．

一方，\emph{系}\index{けい@系}（\emph{corollary}）とは，既に証明された定理や命題から直接的に導かれる結果のことである．\textbf{Cor}と略記される．系は先の結果を応用することで容易に得られる新たな命題であり，元の定理の応用例や特別な場合を示すことが多い．

補題や系を説明するためには，関連するいくつかの命題や定理が必要である．以下に具体的な例を示す．

\phantomsection
\begin{example}{（補題）ユークリッドの補題}{（補題）ユークリッドの補題}
  ユークリッドの補題は，整数論における基本的な結果であり，素因数分解の一意性を証明する際に重要な役割を果たす．その主張は以下の通りである：

  \begin{quote}
    素数$p$が整数$a$と$b$の積$ab$を割り切るならば，$p$は$a$と$b$の少なくとも一方を割り切る．
  \end{quote}

\end{example}

\begin{tleftbar}
  \begin{proof}
    素数$p$が$ab$を割り切るとする．もし$p$が$a$を割り切らないならば，$\gcd(p, a) = 1$である．
    このとき，ベズーの等式より，ある整数$s$と$t$が存在して，$sp + ta = 1$が成り立つ．
    両辺に$b$を掛けると，$spb + tab = b$となる．
    左辺の$spb$は$p$で割り切れるが，$tab$は$p$で割り切れるため，
    右辺の$b$も$p$で割り切れる．したがって，$p$は$b$を割り切る．
  \end{proof}
\end{tleftbar}

この補題を用いて，素因数分解の一意性（算術の基本定理）を証明することができる．

\phantomsection
\begin{example}{自然数の約数の個数}{自然数の約数の個数}
  自然数$n$の正の約数の個数$d(n)$は，$n$の素因数分解に基づいて以下の式で与えられる：

  \begin{equation}
    d(n) = (e_1 + 1)(e_2 + 1) \dotsm (e_k + 1)
  \end{equation}

  ただし，$n$を素因数分解して$n = p_1^{e_1} p_2^{e_2} \dotsm p_k^{e_k}$と表した．
\end{example}

\begin{tleftbar}
  \begin{proof}
    各素因数$p_i$について，指数$e_i$は$0$から$e_i$までの値を取り得る．
    したがって，各$p_i$に対する約数の取り得る指数の個数は$e_i + 1$個である．
    全ての素因数について独立に指数を選ぶことで，
    $n$の全ての約数を生成できるため，約数の総数は各$(e_i + 1)$の積となる．
  \end{proof}
\end{tleftbar}

この命題は，素因数分解の一意性から直接的に導かれる結果である．

そしてこの例から，次の系が導かれる：

\phantomsection
\begin{example}{（系）約数の個数が奇数となる条件}{（系）約数の個数が奇数となる条件}
  自然数$n$の約数の個数$d(n)$が奇数となるための必要十分条件は，$n$が完全平方数であることである．
\end{example}

\begin{tleftbar}
  \begin{proof}
    約数の個数$d(n) = (e_1 + 1)(e_2 + 1) \dotsm (e_k + 1)$である．
    各$(e_i + 1)$が奇数となるためには，$e_i$が偶数でなければならない．
    つまり，全ての素因数の指数$e_i$が偶数であるとき，$n$は各素因数の偶数乗の積であり，
    これは$n$が完全平方数であることと同値である．
    逆に，$n$が完全平方数であれば，各$e_i$は偶数であり，したがって$d(n)$は奇数となる．
  \end{proof}
\end{tleftbar}

\phantomsection
\subsection{言い回し}
\phantomsection
\subsubsection{存在}



数学の証明において，「存在\index{そんざい@存在}」は重要な概念である．といっても，あまりこのことを意識したことのない読者の方もいると思うので，この場を借りて具体例をもとに説明を試みることとする．

まず，「最大値・最小値の定理」を考えてみる．この定理は，
\begin{quotation}
  $[a,b]$で連続な関数$f$に対して，$f$は$[a,b]$上で最大値と最小値を持つ．
\end{quotation}
というものがある．

「最大値・最小値が存在するなんて当たり前だ」と思われる読者もいるかもしれない．しかし，本当にそれは自明なのか．
実際には，関数の連続性や区間の閉有界性といった条件が揃って初めて，最大値や最小値の「存在」を保証できる．この定理を証明するにあたっては，厳密な数学的議論が必要となる．

次に，「極限値の存在」を考えてみよう．

\begin{prop}{}{}
  以下のような漸化式で定められた数列$(x_n)_{n \in \mathbb{N}}$を考える：
  \[
    \begin{cases}
      x_1 =0 , \\
      x_{n+1}= \sqrt{x_n+2}.
    \end{cases}
  \]
  このとき，$(x_n)_{n \in \mathbb{N}}$は収束し，
  \[
    \lim_{n \to \infty} x_n =2
  \]
  である．
\end{prop}

\begin{tleftbar}
  \begin{proof}
    いくつかの補題を確認しつつ示す．
    \begin{lemma}{}{}
      任意の$n \in \mathbb{N}$に対して，
      \[
        x_n \leqq x_{n+1} < 2
      \]
      である．
    \end{lemma}

    \begin{dotleftbar}
      \begin{proof}
        数学的帰納法により，$x_n \leqq x_{n+1} < 2$を示す．
        \begin{enumerate}[(I)]
          \item \mbox{} \\ \label{proof:存在1}
                $n=1$のとき，$ x_1 =0$，$x_2= \sqrt{0+2}=\sqrt{2}$なので，$ 0 \leqq \sqrt{2} < 2$により，
                $x_1 \leqq x_2 < 2$である．
          \item \mbox{} \\ \label{proof:存在2}
                $k \in \mathbb{N}$を任意にとり，$x_k \leqq x_{k+1} < 2$であると仮定する．

                このとき，$x_{k+1} < 2$により$ x_{k+1}+2 < 4$なので，
                \[
                  x_{k+2}=\sqrt{x_{k+1} + 2} < 2
                \]
                である．

                また，$x_k \leqq x_{k+1}$により，$x_k +2  \leqq x_{k+1}+2$であるから，
                \[
                  x_{k+1}= \sqrt{x_k +2} \leqq \sqrt{x_{k+1}+2}=x_{k+2}.
                \]
                よって，$n=k+1$の場合にも成り立つ．
        \end{enumerate}
        以上\ref{proof:存在1}，\ref{proof:存在2}により，任意の$n \in \mathbb{N}$について
        \[
          x_n \leqq x_{n+1} < 2
        \]
        である．
      \end{proof}
    \end{dotleftbar}

    \begin{lemma}{}{}
      $(x_n)_{n \in \mathbb{N}}$は$ 0<  x \leqq 2$なる極限$x$に収束する．
    \end{lemma}

    \begin{dotleftbar}
      \begin{proof}
        先の補題により，任意の$n \in \mathbb{N}$について，$ x_n \leqq x_{n+1} <2$なので，
        数列$(x_n)_{n \in \mathbb{N}}$は単調に増加し，上に有界である．

        よって
        \[
          x \coloneqq \sup \{ x_n \mid n \in \mathbb{N} \}
        \]
        が存在し，$x \leqq  2$である．

        $ x>0$は明らかであるから，以上の考察によりこの命題が証明された．
      \end{proof}
    \end{dotleftbar}

    ここまでで，$(x_n)_{n \in \mathbb{N}}$の極限値の存在が確認されたので，先の漸化式について，
    \[
      x=\sqrt{x+2}
    \]
    とする．これを解くと$ x= -1,2$であるが，$x>0$により$x=2$である．

    以上の考察により，数列$(x_n)_{n \in \mathbb{N}}$は収束し，
    \[
      \lim_{n \to \infty} x_n =2.
    \]
  \end{proof}
\end{tleftbar}

ここまで考察して，ようやく数列$(x_n)_{n \in \mathbb{N}}$が収束することを確認できた．
この例では「極限値の存在」を確認する意味がわからない読者もいるかもしれないので，もう一つ例を挙げよう．


以下のような漸化式で定められた数列$(y_n)_{n \in \mathbb{N}}$を考える：
\[
  \begin{cases}
    y_1 =1 , \\
    y_{n+1}= 2y_n +2.
  \end{cases}
\]
この数列の極限値が存在すると仮定して，それを$y$とおこう．
\begin{tleftbar}
  与えられた漸化式により，
  \begin{align*}
     & y = 2y +2,           \\
     & \therefore ~ y = -2.
  \end{align*}
  しかし，
  \[
    \lim_{n \to \infty} y_n = \infty
  \]
  なので，$y=-2$は誤りである．
\end{tleftbar}

このように，数列の極限が存在することを確認しないと，誤った結論に到達することがある．この例から分かるように，存在を確認することは重要なことであるのだ．


\phantomsection
\subsubsection{一意性}

数学において「一意性\index{いちいせい@一意性}」が重要である場面は多い．読者の中には線型代数の講義で「逆行列の一意性」などに触れた方もいると思われる．なぜ重要であるのか，一つ例を挙げて考えてることとする．

微分積分の講義で習う定理に「平均値の定理」というものがある．
その主張は
\begin{quotation}
  $[a,b]$で連続，$(a,b)$で微分可能な関数$f$に対して，
  \[
    \frac{f(b)-f(a)}{b-a}=f'(c)
  \]
  をみたす$ c \in (a,b)$が存在する．
\end{quotation}

というものである．証明はのちに述べるとして，この定理の主張を少し変更してみよう：

\begin{quotation}
  $[a,b]$で連続，$(a,b)$で微分可能な関数$f$に対して，
  \[
    \frac{f(b)-f(a)}{b-a}=f'(c)
  \]
  をみたす$ c \in (a,b)$がただひとつ存在する．
\end{quotation}

ここでは「$c \in (a,b)$が存在する」という主張を「$c \in (a,b)$がただひとつ存在する」というより強い主張に変更した．この主張の真偽は偽である．以下で，このことが問題になる状況を挙げよう．

\begin{wrapfigure}[7]{r}{0.55\textwidth}
  \centering
  \begin{tikzpicture}[scale=0.7]
    \begin{axis}[
        axis lines=middle,
        xmin=-1.2, xmax=1.2,
        ymin=-1.5, ymax=1.5,
        xtick=\empty, ytick=\empty, % 目盛を消す
        xlabel={}, ylabel={},       % ラベルを消す
        samples=200,
        domain=-1.2:1.2,
        width=10cm,
        height=8cm,
      ]
      % 関数 f(x) = x^3 のグラフ
      \addplot [dblue, thick] {x^3};

      % 点 (-1, -1) と (1, 1) を結ぶ割線
      \addplot [dred, thick] coordinates {(-1, -1) (1, 1)};

      % 平均値の定理を満たす点 x = -1/√3 の接線
      \def\xone{-1/sqrt(3)}
      \def\yone{(\xone)^3}
      \addplot [dgreen, dashed] {1*(x - \xone) + \yone};

      % 平均値の定理を満たす点 x = 1/√3 の接線
      \def\xtwo{1/sqrt(3)}
      \def\ytwo{(\xtwo)^3}
      \addplot [dgreen, dashed] {1*(x - \xtwo) + \ytwo};

      % 重要な点をマーク
      \addplot [only marks, mark=*, mark options={fill=black}] coordinates {(\xone, \yone) (\xtwo, \ytwo)};
      \addplot [only marks, mark=*, mark options={fill=dred}] coordinates {(-1, -1) (1, 1)}; % 赤い丸に変更
    \end{axis}
  \end{tikzpicture}
\end{wrapfigure}
$f(x)=x^3$という関数を考える．この関数は$[-1,1]$で連続，$(-1,1)$で微分可能である．

このとき，図のように，条件を満たす$c \in (-1,1)$は複数存在するので，「ただひとつ存在する」という主張は偽である．
さらに言えば，2本より多くこのような接線を引ける場合もある\footnote{確認してみよ．}．

このことから，安易に「ただ一つ存在する」などと強い主張をすることは避けるべきであることがわかる．このことは平均値の定理に限らず，中間値の定理なども同様である．


\phantomsection
\subsubsection{かつ・または}

数学において，「かつ」は日常とほとんど同じ意味で使われるが，「または」の使い方は日常とは異なる．以下に例を挙げよう．

\phantomsection
\begin{example}{「または」の使用例}{「または」の使用例}
  \begin{enumerate}[(A)]
    \item ランチメニューの主食として，米またはパンがついてくる\footnote{この文を「米とパンの両方が食べられる」と解釈してもらっては困る．}．\label{enu:米またはパン}
    \item 「運転免許を持っていない人」または「18歳未満の人」はレンタカーを借りることができない． \label{enu:運転免許または18歳未満}
  \end{enumerate}
  \ref{enu:米またはパン}は「どちらか片方のみ」の意味で「または」を使い，\ref{enu:運転免許または18歳未満}は「いずれかが」の意味で「または」を用いている．
\end{example}

数学では，「または」は「いずれかが」の意味で使われ，「どちらか片方のみ」の意味で使われることはない．

たとえば，$A$，$B$を集合とするとき，
\[
  x \in A \cup B
\]
は「$x$は$A$の元であるか，$B$の元であるか，あるいは両方である」という意味である．
つまり，「$ x \in A$であり，$x \notin  B$である」あるいは「$ x \notin A$であり，$x \in B$である」といった状況のときにも，$x \in A \cup B$と記す．
%ここまで

\subsubsection{任意の/すべての}

数学において，「任意の\index{にんいの@任意の}」と「すべての\index{すべての@すべての}」はニュアンスが異なる．
英語では，「任意の」は``for any''，「すべての」は``for all''に相当する．
``for any''のニュアンスは「複数の対象があり，その中のどの一つをとっても」という意味であり，``for all''は「対象全体を見て，すべてのものが」という意味である．

このことからわかるように，「任意の」を「すべての」で置き換える場合には，このようなニュアンスの違いに注意しなければならない．

\subsubsection{簡単のため\index{かんたんのため@簡単のため}}

「簡単にするために」のほうがしっくりくる方もおられるかもしれないが，これは``For simplicity''の訳で，
その後の議論を簡単にするために「議論することが楽な仮定」を設ける際に使う言葉である．

\begin{example}{「簡単のため」の使用例}{「簡単のため」の使用例}
  \begin{enumerate}[(A)]
    \item $\lim_{n \to \infty} a_n$が存在することをを示したい．簡単のため，$(a_n)_{n \in \mathbb{N}}$は実数列とする．
  \end{enumerate}
\end{example}

\subsubsection{従う\index{したがう@従う}}

数学において「従う」は日常とはまた違った意味で使われる．日常だと「王に従う」や「上司に従う」など，「命令を受けてそれに従う」という意味で使われることが多いが，
数学では「$A$という事柄から，すぐ$B$という事柄がわかる」という場合に「$A$から$B$が従う」という．

\begin{example}{「従う」の使用例}{「従う」の使用例}
  \begin{enumerate}[(A)]
    \item $n$が偶数であることから，$n^2$が偶数であることが従う．\label{enu:偶数ならば偶数}
    \item $G$が群であることから，$G \ne \varnothing$が従う\footnote{群であれば単位元が存在することは群の定義からわかる．そのため群は空集合でない．}．\label{enu:群の例}
  \end{enumerate}
\end{example}

\subsubsection{嬉しい\index{うれしい@嬉しい}}

日常では，「嬉しい」という言葉は「喜びを感じる」という意味で使われることが多いが，数学の文脈では「都合がよい」，「議論が楽になる」という意味でたびたび使われる．

\begin{example}{「嬉しい」の使用例}{「嬉しい」の使用例}
  \[
    \int_{\alpha}^{\beta} (x-\alpha)(x-\beta)\, dx = -\frac{(\beta-\alpha)^3}{6}
  \]
  であることを示したい．このときに
  \[
    \int_{\alpha}^{\beta} (x-\alpha)(x-\beta)\, dx = \int_{\alpha}^{\beta}  (x-\alpha)\{(x-\alpha) - (\beta-\alpha)\} \, dx
  \]
  と変形してなにが嬉しいかというと，
  \begin{align*}
    \int_{\alpha}^{\beta}  (x-\alpha)\{(x-\alpha) - (\beta-\alpha)\} \, dx & = \int_{\alpha}^{\beta} \{  (x-\alpha)^2 -(\beta-\alpha)(x-\alpha) \} \, dx                        \\
                                                                           & = \Biggl [ \frac{(x-\alpha)^3}{3} - \frac{(\beta-\alpha)(x-\alpha)^2}{2} \Biggr ]_{\alpha}^{\beta} \\
                                                                           & = - \frac{1}{6} (\beta-\alpha)^3
  \end{align*}
  というふうに，簡単に計算できるからである．
\end{example}



\subsubsection{おさえる\index{おさえる}・評価\index{ひょうか@評価}する}

数学の文脈では「おさえる」という言葉は，ある数$M$を，別の数 $K$を用いて，$K<M$という形で表すことを指す．
より詳しく「上からおさえる」と表すこともある．

また，数学の文脈で「評価」という言葉は，ある数$M$を不等式で表し，その数がどの程度の大きさであるかを示すことを指す．
たとえば，$ 1 < M <4$と表すことは「$M$を$1$より大きく$4$より小さいと評価する」ということを指す．
さらに，上記の$M$を$ 2< M <3$と表すことができる場合は，後者の表現のほうが「評価が厳しい」ということができる．

\begin{example}{「おさえる」と「評価する」の使用例}{「おさえる」と「評価する」の使用例}
  \begin{enumerate}[(A)]
    \item 数列$(a_n)_{n \in \mathbb{N}}$を $ a_n <M$と上からおさえる．
    \item $e$の値を$2.7 < e < 2.8$と評価する．
  \end{enumerate}
\end{example}


\subsubsection{特徴づけ\index{とくちょうづけ@特徴づけ}}

数学の文脈では，「特徴づけ」という言葉がよく使われる．これは，ある対象が持つ性質を使ってその対象をただひとつと特定することを指す．

\begin{example}{「特徴づけ」の使用例}{「特徴づけ」の使用例}
  \begin{enumerate}[(A)]
    \item 実数の連続性の公理は，実数の集合を特徴づけるものである\footnote{この言葉の意味がよくわからない読者は，解析学の教科書を参照してみることを推奨する．}．
  \end{enumerate}
\end{example}

\newpage

\phantomsection
\section{論理と証明}
\phantomsection
\subsection{論理}
\phantomsection
\subsubsection{命題論理\index{めいだいろんり@命題論理}}

命題論理では，命題を結合するために記号を用いる．代表的な論理記号を列挙してみよう：

\begin{table}[ht]
  \centering
  \caption{命題論理の記号}
  \begin{tabular}{c|c}
    \hline
    記号                & 意味                       \\
    \hline
    $\land$           & かつ（論理積\index{ろんりせき@論理積}） \\
    $\lor$            & または（論理和\index{ろんりわ@論理和}） \\
    $\lnot$           & 否定\index{ひてい@否定}         \\
    $\to$             & ならば（含意\index{がんい@含意}）    \\
    $\Leftrightarrow$ & 必要十分条件（同値）\index{どうち@同値} \\
    \hline
  \end{tabular}
\end{table}

これらの論理記号を用いて，命題を結合し，複雑な論理式を構成することができる．
以下に，基本的な命題の真理値表を載せよう．

\begin{table}[htbp]
  \begin{center}
    \begin{tabular}{c}

      \begin{minipage}{0.3\hsize}
        \begin{center}
          \caption{論理和（積）の真理値表}
          \label{fig:論理和（積）の真理値表}
          \begin{tabular}{|c|c|c|c|} \hline
            $P$           & $Q$          & $P \land Q$   & $P \lor Q$    \\ \hline
            $\mathrm{T}$  & $\mathrm{T}$ & $\mathrm{T}$  & $\mathrm{T}$  \\ \hline
            $\mathrm{T} $ & $\mathrm{F}$ & $\mathrm{F}$  & $\mathrm{T}$  \\ \hline
            $\mathrm{F} $ & $\mathrm{T}$ & $\mathrm{F} $ & $\mathrm{T}$  \\  \hline
            $\mathrm{F}$  & $\mathrm{F}$ & $\mathrm{F}$  & $\mathrm{F} $ \\ \hline
          \end{tabular}
        \end{center}
      \end{minipage}

      \begin{minipage}{0.3\hsize}
        \begin{center}
          \caption{否定命題の真理値表}
          \label{fig:否定命題の真理値表}
          \begin{tabular}{|c|c|} \hline
            $P $         & $\lnot P$    \\ \hline
            $\mathrm{T}$ & $\mathrm{F}$ \\ \hline
            $\mathrm{F}$ & $\mathrm{T}$ \\\hline
          \end{tabular}
        \end{center}
      \end{minipage}

      \begin{minipage}{0.3\hsize}
        \begin{center}
          \caption{恒真命題と矛盾命題の真理値表}
          \label{fig:恒真命題と矛盾命題の真理値表}
          \begin{tabular}{|c|c|c|c|} \hline
            $ P$          & $\lnot P$     & $ P \lor \lnot P $ & $P \land \lnot P$ \\ \hline
            $\mathrm{T} $ & $\mathrm{F} $ & $\mathrm{T}$       & $\mathrm{F}$      \\ \hline
            $\mathrm{F} $ & $\mathrm{T}$  & $\mathrm{T}$       & $\mathrm{F}$      \\\hline
          \end{tabular}
        \end{center}
      \end{minipage}
    \end{tabular}
  \end{center}
\end{table}

\phantomsection
\subsubsection{述語論理\index{じゅつごろんり@述語論理}}

\exref{命題でない文}の\ref{enu:命題でない文4}において，「$x^2 >4$」という文について考えた．この文は命題ではないが，たとえば$x=3$を代入したときは真，$x=0$を代入したときは偽である．
つまり，$x$になにかしら値を代入すると，この文は真偽が決まり，命題となるのである．

このような「値が決まっていない変数を含み，変数に何かを代入すると真偽が判定できる」という性質を持つ文を\emph{述語}\index{じゅつご@述語}という．
そして，述語を用いて命題を表現する論理を\emph{述語論理}\index{じゅつごろんり@述語論理}という．


述語論理においてはいくつかの記号を用いる．次の表で確認しよう：

\begin{table}[ht]
  \centering
  \caption{述語論理の記号}
  \begin{tabular}{c|c}
    \hline
    記号        & 意味                              \\
    \hline
    $\forall$ & 任意の（全称量化\index{ぜんしょうりょうか@全称量化}） \\
    $\exists$ & 存在する（存在量化\index{そんざいりょうか@存在量化}） \\
    \hline
  \end{tabular}
\end{table}

これらの記号を用いて，述語を命題にすることができる．$\forall$と$\exists$をまとめて\emph{量化子}\index{りょうかし@量化子}とよぶ．

\phantomsection
\begin{definition}{全称命題}{全称命題}
  $P(x)$を述語とする．
  \[
    \forall\, x \, : \, P(x)
  \]
  は，「すべての$x$について，$P(x)$が成り立つ」という意味であり，これを\emph{全称命題}\index{ぜんしょうめいだい@全称命題}という．
\end{definition}

\phantomsection
\begin{definition}{存在命題}{存在命題}
  $Q(x)$を述語とする．
  \[
    \exists \,  x\, : \, Q(x)
  \]
  は，「$Q(x)$が成り立つような$x$が存在する」という意味であり，これを\emph{存在命題}\index{そんざいめいだい@存在命題}という．
\end{definition}

\phantomsection
\begin{example}{量化記号の例}{量化記号の例}
  \begin{itemize}
    \item $\forall x \in \mathbb{R}\, : \, x^2 \geq 0$\\
          「任意の実数$x$について，$x^2$は$0$以上である．」
    \item $\exists x \in \mathbb{Z} \, : \, x^2 = 4$\\
          「ある整数$x$が存在して，$x^2 = 4$となる．」
  \end{itemize}
\end{example}

\phantomsection
\subsection{証明}

\phantomsection
\subsubsection{証明とは}
数学において，主張が正しいことを示すプロセスを\emph{証明}\index{しょうめい@証明}（\emph{proof}）という．

先の例で，命題・定理・補題・系は証明されるべきものであるが，定義は一般に「証明すべきこと」でないことに注意したい．
しかし，例えば「\exref{「絶対値」の定義}において$\abs{x} \coloneqq \max \{ x, -x \}$を仮定して$\abs{x} = \sqrt{x^2}$を導く」
など，異なる定義の同値性を示す場面では，定義が「証明すべきもの」となる．このことから，どの定義を採用しているか明確にすることが重要であることがわかる．

証明は一つの命題にいくつか存在する場合がほとんどであり，たとえば，\exref{三平方の定理}の証明は100通り以上も存在することが知られている．
\phantomsection
\begin{example}[sidebyside, % sidebysideオプションを局所的に有効化
    lefthand width=7cm, % 図の幅を指定
    righthand width=7cm, % テキストの幅を調整
    sidebyside gap=5mm, % 図とテキスト間のスペース
  ]{証明}{証明}
  辺の長さが$a$と$b$の直角三角形を$4$つ用意する．
  これらの三角形を組み合わせて，辺の長さが$a + b$の正方形を作る．
  このとき，大きな正方形の面積は$(a + b)^2$である．

  一方で，大きな正方形は中央に辺の長さが$c$の小さな正方形と，$4$つの三角形で構成されている．

  よって，大きな正方形の面積は，小さい正方形の面積と4つの三角形の面積の和に等しい．ゆえに
  \[
    (a + b)^2 = c^2 + 4 \left( \frac{1}{2}ab \right), \quad \therefore ~(a + b)^2 = c^2 + 2ab.
  \]
  これにより，
  \[
    a^2 + 2ab + b^2 = c^2 + 2ab, \quad \therefore ~a^2 + b^2 = c^2.
  \]
  これが証明すべきことであった．\qed
  \tcblower
  % 左側に表示する図
  \begin{tikzpicture}[scale=0.75]
    % 辺の長さの定義
    \def\a{3}
    \def\b{4}
    \def\c{5}

    % 大きな正方形の描画
    \draw (0,0) rectangle (\a+\b,\a+\b);

    % 4つの直角三角形の描画
    % 第1の三角形
    \draw (0,0) -- (\b,0) -- (0,\a) -- cycle;
    \draw (0,\a) -- node[midway,above] {$c$} (\b,0);

    % 第2の三角形
    \draw (\b,0) -- (\a+\b,0) -- (\a+\b,\b) -- cycle;
    \draw (\a+\b,\b) -- node[midway,above] {$c$} (\b,0);

    % 第3の三角形
    \draw (\a+\b,\b) -- (\a+\b,\a+\b) -- (\a,\a+\b) -- cycle;
    \draw (\a,\a+\b) -- node[midway,above] {$c$} (\a+\b,\b);

    % 第4の三角形
    \draw (\a, \a+\b) -- (0, \a+\b) -- (0,\a) -- cycle;
    \draw (0,\a) -- node[midway,above] {$c$} (\a, \a+\b);

    % 中央の小さな正方形の描画
    \draw (\b,0) -- (\a+\b,\b) -- (\a,\a+\b) -- (0,\a) -- cycle;

    % 寸法のラベル
    \draw [<->] (-0.5,0) -- (-0.5,\a) node[midway,left] {$a$};
    \draw [<->] (-0.5,\a) -- (-0.5,\a+\b) node[midway,left] {$b$};
    \draw [<->] (0,-0.5) -- (\b,-0.5) node[midway,below] {$b$};
    \draw [<->] (\b,-0.5) -- (\a+\b,-0.5) node[midway,below] {$a$};

  \end{tikzpicture}
\end{example}


\begin{mycolumn}
  証明を記述する際には，文末に$\square$や$\blacksquare$を記すことが一般的である．そのほかに``Q.E.D.''\footnote{quod erat demonstrandumの略で，ラテン語で「証明されるべきことでありつづけたこと」という意味である．}などの表現も用いられる．
\end{mycolumn}

\phantomsection
\subsubsection{命題の反証と反例}

数学において，「すべての$n$に対して$P(n)$が成り立つ」という全称命題が偽であることを証明するには，\textbf{反例}を一つ示すだけで十分である．これは，全称命題が「すべての場合において成り立つ」ことを主張しているため，一つでも例外があれば命題全体が偽となるからである．

\phantomsection
\begin{example}{反例による反証}{反例による反証}
  次の命題を考える：
  \[
    \forall n \in \mathbb{N}\, : \, \frac{n^3}{24} + 84 \geq n^2.
  \]
  この命題が成り立たないことを示すためには，ある$n$について不等式が成立しないことを示せばよい．実際に，$n = 15$のとき，
  \[
    \frac{15^3}{24} + 84 = \frac{3375}{24} + 84 = 140.625 + 84 = 224.625.
  \]
  一方，
  \[
    15^2 = 225.
  \]
  したがって，
  \[
    \frac{15^3}{24} + 84 = 224.625 < 225 = 15^2.
  \]
  このように，$n = 15$において不等式が成り立たないため，元の命題は偽であることが分かる．
\end{example}

また，全称命題が偽であることを証明する際には，「反例をどう見つけたか」ということは明記しない場合が多い．
たとえば\exref{反例による反証}の場合に$n=15$を見つけるには，微分法を用いて議論したり様々な方法があるが，そのような「反例を見つけるまでの過程」を説明する必要はなく，「$n=15$の場合に命題が成り立たないこと」のみを証明として書けばよい．

\phantomsection
\subsubsection{様々な証明法}

\begin{description}
  \item[帰納法\index{きのうほう@帰納法}] \mbox{} \\
        たとえば数学的帰納法は，数学的な主張が自然数全体に対して成り立つことを示すための証明法である．
  \item[背理法\index{はいりほう@背理法}] \mbox{} \\
        「$P$が成り立たないと仮定すると矛盾が生じる」という論理的な構造を用いて証明を行う方法である．
  \item[直接証明\index{ちょくせつしょうめい@直接証明}] \mbox{} \\
        「$P$が成り立つことを示す」という形式で証明を行う方法である．
\end{description}

以下では，「$n \geq 2$ をみたす任意の自然数について，$2^n > n$である」という命題を3通りのやり方で証明してみよう．

\phantomsection
\begin{example}{帰納法}{帰納法}
  \begin{enumerate}[(I)]
    \item $n=2$のとき，
          \[
            2^2 = 4 > 2
          \]

          となり，与えられた不等式は成立する．
    \item 自然数$k$を$k \geqq 2$を満たすように任意にとる．$2^k > k$ が成り立つと仮定する．このとき，
          \[
            2^{k+1} = 2 \cdot 2^k > 2k.
          \]
          ここで，$k \geqq 2$であるから，$2k - (k + 1) = k - 1 \geq 1$であるがゆえに，$2k > k + 1$である．

          したがって，

          \[
            2^{k+1} > 2k > k + 1.
          \]
          ゆえに，$n=k+1$のときも$2^{k+1} > k + 1$である．
  \end{enumerate}

  以上の考察と数学的帰納法により，$2^n > n$ は $n \geq 2$をみたすすべての自然数について成り立つ．\qed
\end{example}

\phantomsection
\begin{example}{背理法}{背理法}
  $n \geqq 2$をみたす自然数で $2^n \leqq n$ となるものが存在すると仮定する．
  $2^n$ の正の約数の個数は，指数に $1$ を加えたものなので，$2^n$の正の約数の個数は $n + 1$ 個以上である．
  しかし，仮定より $2^n \leqq n$ なので，$2^n$ は $n$ 以下の数である．

  これは，$n$ 以下の数が $n + 1$ 個以上の正の約数を持つことを意味するが，これは矛盾である．

  したがって，先の仮定が誤りであるため，背理法によって$2^n > n$ が成り立つ．\qed
\end{example}

\phantomsection
\begin{example}{直接証明}{直接証明}
  \[
    2^n = n \int_{1}^{2} x^{n-1} \, dx + 1
  \]
  となることはよい．さて，$x \in [1, 2]$ かつ $n \geqq 2$ なので，
  \[
    x^{n-1} \geqq x^{1} \geqq 1
  \]
  が成り立つ．したがって，
  \begin{align*}
    2^n & = n \int_{1}^{2} x^{n-1} \, dx + 1 \\
        & \geqq  n \int_{1}^{2} \, dx +1     \\
        & = n+1.
  \end{align*}
  これと$n+1 >n$であることを併せると，$n \geqq 2$のとき$2^n > n$である．\qed
\end{example}
\newpage

\phantomsection
\section{集合}
\phantomsection
\subsection{集合の定義と表記法}

\phantomsection
\subsubsection{集合の定義}

現代数学の基礎をなす概念に「集合」や「写像」がある．まず「集合」からみていこう．
\phantomsection
\begin{definition}{集合}{集合}
  もののあつまりを\emph{集合}\index{しゅうごう@集合}という\footnote{公理的集合論の立場では，集合とは「無定義語」であるが，ここで詳しくは触れない．}．集合を構成するものを\emph{元}\index{げん@元}または\emph{要素}\index{ようそ@要素}といい，集合$A$の元が$a$であることを$a \in A$，$A \ni a$などと表す．
\end{definition}

集合に関して，いくつか注意点を挙げよう．

\begin{itemize}
  \item 集合では書き並べる順序が重要でないため，例えば $\{1, 2, 3\} = \{3, 2, 1\}$である．
  \item 同じ要素が重複して含まれていても，1つの要素として扱われるため，例えば$\{1, 1, 2, 2, 2, 3\} = \{1, 2, 3\}$である．
  \item 集合の要素には，種類が異なるものを同時に含めることができる．例えば，$\{4, \{3\}\}$では，$4$は数であり，$\{3\}$は集合であるが，集合としての資格がある．
\end{itemize}

「ある集合の要素を部分的に含んでいる集合」を考えることは，数学において重要な意義を持つ．
といっても，現段階で部分集合のイメージを掴むことは難しいので，まず定義を確認して，部分集合の具体的な例はのちほど紹介することにする．

\begin{definition}{集合の相等}{集合の相等}
  集合$A$，$B$のすべての要素が一致しているとき，$A$と$B$は\emph{相等}\index{そうとう@相等}であるといい，これを
  \[
    A = B
  \]
  と表す．

  また，集合$A$と$B$が相等でないとき，
  \[
    A \ne B
  \]
  と表す．
\end{definition}

\begin{mycolumn}
  \deref{集合の相等}を考える意義がぴんとこない読者もいるかもしれない．
  だが，たとえば$\pi$，$\int_{0}^{1} \frac{4}{1+x^2} \, dx$，$4 \sum_{n=0}^{\infty} \frac{(-1)^n}{2n+1}$は異なる表現であるが，すべて円周率を表している．
  このような例からわかるように，「相等」を考えることは数学的な主張を正確に表現するために重要なことなのだ．
\end{mycolumn}

\phantomsection
\begin{definition}{部分集合}{部分集合}
  集合$A$の要素がすべて集合$B$の要素でもあるとき，$A$は$B$の\emph{部分集合}\index{ぶぶんしゅうごう@部分集合}であるといい，これを
  \[
    A \subset B,\quad B \supset A
  \]
  などと表す\footnote{このことを$ A \subseteq B$，$B \supseteq A$とかくこともある．一般に，$A \subset B$，$ B \supset A$と書いた場合には$A=B$の場合を含んで意味をとる．}．
\end{definition}

\begin{definition}{真部分集合}{真部分集合}
  集合$A$の要素がすべて集合$B$の要素であり，なおかつ$A \ne B$であるとき，$A$は$B$の\emph{真部分集合}\index{しんぶぶんしゅうごう@真部分集合}であるといい，これを
  \[
    A \subsetneq B,\quad B \supsetneq A
  \]
  などと表す．
\end{definition}

\phantomsection
\subsubsection{集合の表記}

数学を勉強する上で，よく使う集合には固有の記号を与える場合が多い．以下ではよく使う集合の例を挙げよう．

\begin{shadebox}
  よく使う集合
  \begin{itemize}
    \item $\mathbb{R}$は実数全体の集合を表している．Real numberの頭文字をとった．
    \item $\mathbb{N}=\{0,1,2,\cdots \}$は自然数全体の集合を表している．Natural number の頭文字をとった．
    \item $\mathbb{C}=\{ a+bi \mid a,b \in \mathbb{R}\}$は複素数全体の集合を表している．Complex number の頭文字をとった．
    \item $\mathbb{Z}=\{0, \pm 1 , \pm 2 , \cdots\}$は整数全体の集合を表している．Zはドイツ語由来である，
    \item $\mathbb{Q}=\{ a/b \mid   a,b \in \mathbb{Z},b \ne 0 \}$は有理数全体の集合を表している．「商」を表すイタリア語由来である．
  \end{itemize}
\end{shadebox}


\begin{shadebox}
  数を表す集合以外にも，固有の表記が与えられている集合が存在する．
  \begin{itemize}
    \item $\varnothing$ \footnote{空集合は$\emptyset$と表記することもある．ギリシャ文字の$\phi$で代用されることもあるが，本来の空集合の記号はノルウェー語由来である．}は要素を一つも持たない集合，すなわち\emph{空集合}\index{くうしゅうごう@空集合}を表している．
    \item $\mathcal{P}(A)$は集合$A$のすべての部分集合からなる集合，すなわち\emph{べき集合}\index{べきしゅうごう@べき集合}を表している．
  \end{itemize}
\end{shadebox}



\phantomsection
\begin{example}{}{}
  \[
    x \in \mathbb{Q}
  \]
  と書くことで，$x$は有理数であることを表す．
\end{example}

\phantomsection
\begin{example}{}{}
  \[
    \mathbb{R} \subset \mathbb{C}
  \]
  である．つまり，実数全体の集合は複素数全体の集合の部分集合である．
\end{example}

\phantomsection
\begin{example}{}{}
  $A$を集合とするとき，
  \[
    \varnothing  \subset A
  \]
  である．つまり，空集合は全ての集合の部分集合である．
\end{example}

\phantomsection
\begin{example}{べき集合}{べき集合}
  $A=\{ 1, 2\}$とすると，
  \[
    \mathcal{P}(A) = \{ \varnothing, \{1\}, \{2\}, \{1, 2\}\}
  \]
  である．
\end{example}



集合の表記は文脈により省略されることがある．たとえば，以下のような問題があったとする．
\begin{quotation}
  2次方程式
  \[
    x^2 - 3x -4 =0
  \]
  を解け．
\end{quotation}
$x$が属する全体集合は定められていないが，この場合だと「$x \in \mathbb{C}$」とされることが多い．
よってこの方程式の解は$x = -1 , 4$とする場合が多い．
だが，もちろん$ x \in \mathbb{N}$とするなら，$ -1 \notin \mathbb{N}$なので，この場合の解は$ x= 4$のみである．
ただ，$x$が属する全体集合は，文脈でわかったり明記されている場合が多いので，あまり心配はいらないと筆者は考える．


また，集合はしばしば条件を用いて記述される．

\begin{description}
  \item[外延的記法\index{がいえんてききほう@外延的記法}（列挙形式）] \mbox{} \\
        $\{ a, b, c \}$のように要素を列挙して表す．
  \item[内包的記法\index{ないほうてききほう@内包的記法}（条件形式）] \mbox{} \\
        $\{ x \in \mathbb{N} \mid x \leq 5 \}$のように条件を用いて表す．
\end{description}


\phantomsection
\begin{example}{集合の表記}{集合の表記}
  \[
    \{ 1,2,3 \} = \{ n \in \mathbb{N} \mid  n^2 -4n +3 \leqq 0 \}
  \]
\end{example}

\phantomsection
\subsection{集合の演算}

\subsubsection{共通部分・和集合・差集合・補集合}
集合に対して，以下のような演算を定義することができる．

\phantomsection
\begin{definition}{共通部分・和集合・差集合・補集合}{共通部分・和集合・差集合・補集合}
  $A$と$B$を集合とするとき，以下の定義をする．
  \begin{description}
    \item[共通部分\index{きょうつうぶぶん@共通部分}] \mbox{}\\
          $A$と$B$の両方に属する要素全体の集合を$A \cap B$と表す．これを``$A$ intersection $B$''と読む．
    \item[和集合\index{わしゅうごう@和集合}] \mbox{} \\
          $A$または$B$のいずれかに属する要素全体の集合を$A \cup B$と表す．これを``$A$ union $B$''と読む．
    \item[差集合\index{さしゅうごう@差集合}]\mbox{}\\
          $A$の要素で$B$に属さないもの全体の集合を$A \setminus B$と表す．
    \item[補集合\index{ほしゅうごう@補集合}] \mbox{}\\
          全体集合$X$に対して，$X \setminus A$は$A$の補集合であり，$A^c$と表す．これを``$A$ complement''と読む．
  \end{description}
\end{definition}


\begin{figure}[ht]
  \centering
  \begin{minipage}{0.45\linewidth}
    \centering
    % A∩B のベン図
    \scalebox{0.9}{
      \begin{tikzpicture}
        % 全体集合の長方形
        \draw (0,0) rectangle (6,4) node[below left] {$X$};
        % 集合Aの円
        \draw (2,2) circle (1.5) node[left] {$A$};
        % 集合Bの円
        \draw (4,2) circle (1.5) node[right] {$B$};
        % 共通部分を塗りつぶす
        \begin{scope}
          \clip (2,2) circle (1.5);
          \fill[gray] (4,2) circle (1.5);
        \end{scope}
      \end{tikzpicture}
    }
    \caption{$A \cap B$ のベン図}
  \end{minipage}
  \hfill
  \begin{minipage}{0.45\linewidth}
    \centering
    % A∪B のベン図
    \scalebox{0.9}{
      \begin{tikzpicture}
        % 全体集合の長方形
        \draw (0,0) rectangle (6,4) node[below left] {$X$};
        % 集合Aの円を塗りつぶす
        \fill[gray] (2,2) circle (1.5);
        % 集合Bの円を塗りつぶす
        \fill[gray] (4,2) circle (1.5);
        % 集合Aの円の輪郭
        \draw (2,2) circle (1.5) node[left] {$A$};
        % 集合Bの円の輪郭
        \draw (4,2) circle (1.5) node[right] {$B$};
      \end{tikzpicture}
    }
    \caption{$A \cup B$ のベン図}
  \end{minipage}

  \vspace{2mm}

  \begin{minipage}{0.45\linewidth}
    \centering
    % A - B のベン図
    \scalebox{0.9}{
      \begin{tikzpicture}
        % 全体集合の長方形
        \draw (0,0) rectangle (6,4) node[below left] {$X$};
        % 集合Aの円
        \draw (2,2) circle (1.5) node[left] {$A$};
        % 集合Bの円
        \draw (4,2) circle (1.5) node[right] {$B$};
        % A - B を塗りつぶす
        \begin{scope}
          \clip (2,2) circle (1.5);
          \fill[gray] (0,0) rectangle (6,4);
        \end{scope}
        \begin{scope}
          \clip (4,2) circle (1.5);
          \fill[white] (0,0) rectangle (6,4);
        \end{scope}
        % 集合Aの円の輪郭
        \draw (2,2) circle (1.5) node[left] {$A$};
      \end{tikzpicture}
    }
    \caption{$A \setminus B$ のベン図}
  \end{minipage}
  \hfill
  \begin{minipage}{0.45\linewidth}
    \centering
    % A^c のベン図
    \scalebox{0.9}{
      \begin{tikzpicture}
        % 全体集合の長方形を塗りつぶす
        \fill[gray] (0,0) rectangle (6,4);
        % 集合Aの円を白で塗りつぶす
        \fill[white] (2,2) circle (1.5);
        % 全体集合の枠
        \draw (0,0) rectangle (6,4) node[below left] {$X$};
        % 集合Aの円の輪郭
        \draw (2,2) circle (1.5) node[left] {$A$};
      \end{tikzpicture}
    }
    \caption{$A^c$ のベン図}
  \end{minipage}
\end{figure}


\phantomsection
\begin{example}{集合}{集合}
  例えば，$A = \{1, 2, 3\}$，$B = \{3, 4, 5\}$とすると，
  \begin{itemize*}
    \item $A \cap B = \{3\}$
    \item $A \cup B = \{1, 2, 3, 4, 5\}$
    \item $A \setminus B = \{1, 2\}$
    \item $X=\{1,2,3,4,5\}$とすると，$A^c = \{4, 5\}$
  \end{itemize*}
\end{example}

\begin{prop}{集合の交換法則}{集合の交換法則}
  $A$，$B$を集合とするとき，
  \[
    A \cap B = B \cap A , \quad A \cup B = B \cup A
  \]
  である．
\end{prop}

\begin{tleftbar}
  \begin{proof}
    共通部分および和集合の定義から従う．
  \end{proof}
\end{tleftbar}

\begin{mycolumn}
  ここで「なぜ交換法則を考えるのか」という疑問が生じるかもしれない．当たり前に成り立つことだと思える読者もいるかもしれないが，よく考えてみると「実数の減法」や「関数（写像）の合成」，「行列の積」など，
  数学において一般に交換法則が成り立たないものは数多く存在する．集合に対して交換法則を考える意義はそこにあるのである．
\end{mycolumn}

\subsubsection{集合の分配律}

\phantomsection
\begin{prop}{集合の分配律}{集合の分配律}
  $A$，$B$，$C$を集合とするとき，
  \begin{align*}
    A \cap ( B \cup C) & = (A \cap B) \cup (A \cap C), \\
    A \cup ( B \cap C) & = (A \cup B) \cap (A \cup C).
  \end{align*}
\end{prop}

\begin{tleftbar}
  \begin{proof}
    まず，
    \[
      A \cap (B \cup C) \subset (A \cap B) \cup (A \cap C)
    \]
    を示す：

    $x \in A \cap (B \cup C)$ とすると，$x$ は $A$ に属し，かつ $B \cup C$ に属する．
    すると $x \in B \cup C$ なので，$x \in B$ または $x \in C$ のいずれかが成り立つ．
    \begin{itemize}
      \item もし $x \in B$ であれば，$x$ は $A$ に属し $B$ にも属するので，$x \in A \cap B$ となる．よって $x \in (A \cap B) \cup (A \cap C)$ が従う．
      \item もし $x \in C$ であれば，$x$ は $A$ に属し $C$ にも属するので，$x \in A \cap C$ となる．よって $x \in (A \cap B) \cup (A \cap C)$ が従う．
    \end{itemize}
    いずれの場合でも $x \in (A \cap B) \cup (A \cap C)$ となるので，
    \[
      A \cap (B \cup C) \subset (A \cap B) \cup (A \cap C)
    \]
    が示された．

    次に，
    \[
      (A \cap B) \cup (A \cap C) \subset A \cap (B \cup C)
    \]
    を示す：

    $x \in (A \cap B) \cup (A \cap C)$ とすると，$x \in A \cap B$ または $x \in A \cap C$ のいずれかが成り立つ．
    \begin{itemize}
      \item もし $x \in A \cap B$ であれば，$x$ は $A$ に属し，かつ $B$ に属する．すると $B \subset B \cup C$ だから $x \in B \cup C$ でもある．よって $x \in A \cap (B \cup C)$ が成り立つ．
      \item もし $x \in A \cap C$ であれば，$x$ は $A$ に属し，かつ $C$ に属する．すると $C \subset B \cup C$ だから $x \in B \cup C$ でもある．よって $x \in A \cap (B \cup C)$ が成り立つ．
    \end{itemize}
    いずれの場合でも $x \in A \cap (B \cup C)$ となるので，
    \[
      (A \cap B) \cup (A \cap C) \subset A \cap (B \cup C)
    \]
    が示された．

    以上の2つの包含関係から，
    \[
      A \cap (B \cup C) =(A \cap B) \cup (A \cap C)
    \]
    が成り立つ．
  \end{proof}
\end{tleftbar}

\draftnote{ここに諸定理を追加予定}

\newpage
\phantomsection
\section{写像}

\phantomsection
\subsection{写像の定義と例}

\phantomsection
\subsubsection{写像の定義}

いままでの数学の学習の過程で「関数\index{かんすう@関数}」という言葉に出会ったことがある読者もいるかもしれない．
そのような経験がある読者は「関数」と言われると，どのようなものが思い浮かぶであろうか．

関数の一般的な表現として「写像」がある\footnote{写像の始集合・終集合が$\mathbb{R}$など「数」の集合であるときに「関数」と呼ぶことが多い．}．厳密な写像の定義はのちに述べるとして，まず簡潔な定義を提示しよう．

\begin{definition}{写像}{写像}
  集合$A$から集合$B$への\emph{写像}\index{しゃぞう@写像}$f$とは，任意の$a \in A$に対して，$b \in B$をただひとつ対応させる規則のことである．

  このとき，$A$を$f$の\emph{始集合}\index{ししゅうごう@始集合} ，$B$を$f$の\emph{終集合}\index{しゅうしゅうごう@終集合}とよぶ．

  これを次のように表す：
  \[
    f \colon A \to B.
  \]
  この写像$f$によって，$a \in A$が$b \in B$に対応するとき，
  \[
    b=f(a)
  \]
  または
  \[
    f \colon a \mapsto b
  \]
  とかく\footnote{これを$ f \colon A \ni a \mapsto b \in B$とかくときもある．}．
\end{definition}

$A=\{ 1,2 ,3 \}$， $B=\{ a, b,c \}$とする．$f(1) = a$，$f(2) = b$，$f(3) = a$とすると，この写像$f$は下図のように表現できる．
\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    % Aの集合
    \draw[fill=cyan!20, draw=cyan] (-2,0) ellipse (1.5cm and 2cm);
    \node at (-2,2.2) {$A$};

    % Bの集合
    \draw[fill=cyan!20, draw=cyan] (3,0) ellipse (1.5cm and 2cm);
    \node at (3,2.2) {$B$};

    % Aの要素
    \fill (-2,1) circle (2pt);
    \node[left] at (-2,1) {$1$};

    \fill (-2,0) circle (2pt);
    \node[left] at (-2,0) {$2$};

    \fill (-2,-1) circle (2pt);
    \node[left] at (-2,-1) {$3$};

    % Bの要素
    \fill (3,1) circle (2pt);
    \node[right] at (3,1) {$a$};

    \fill (3,0) circle (2pt);
    \node[right] at (3,0) {$b$};

    \fill (3,-1) circle (2pt);
    \node[right] at (3,-1) {$c$};

    % 矢印（写像）
    \draw[->, thin] (-2,1) to[bend left=20] (3,1); % 1をaに対応
    \draw[->, thin] (-2,0) to[bend left=0] (3,0); % 2をbに対応
    \draw[->, thin] (-2,-1) to[bend left=20] (3,1); % 3をaに対応
  \end{tikzpicture}
  \caption{写像 $f \colon A \to B$}
\end{figure}

この例では，$1$と$3$がともに$a$に対応しているが，上記の写像の定義ではこのような場合があってもよい．
また，$A$のどの元にも対応しない元$c$の存在も許容される．

学習が進むと，「任意の$ a_1 , a_2 \in A$に対して，$ a_1 \ne a_2$ならば$f(a_1) \ne f(a_2)$である写像」や
「任意の$ b \in B$に対して，ある$a \in A$が存在して，$b=f(a)$となる写像」を考える場合もあるが，この説明はもう少しあとにしよう．

\phantomsection
\subsubsection{写像の例}

ここでは直感的な理解を深めるために，具体例を挙げてみよう．

\begin{example}{自動販売機}{自動販売機}
  自動販売機には複数のボタンがあり，それぞれが特定の飲み物に対応している\footnote{ボタンをひとつ押しただけで何種類も飲み物が出てくる自動販売機はまずないであろう．少なくとも筆者は知らない．}．

  集合$A$を自動販売機のボタンの集合，集合$B$を提供される飲み物の集合としよう．各ボタン $a \in A$ に対して，そのボタンを押すと出てくる飲み物を $b \in B$ とする．

  このとき，
  \[
    b=f(a)
  \]
  とかくと，$f$ は写像の定義を満たす．
\end{example}


\subsubsection{像（値域）と逆像}

\begin{definition}{像（値域）}{像（値域）}
  写像$f \colon A \to B$において，集合$A$の部分集合$A' \subset A$に対する\emph{像}（\emph{値域}）$f(A')$とは，
  \[
    f(A') = \{ f(a) \mid a \in A' \}
  \]
  で定義される集合である．特に，$A' = A$のときの$f(A)$を$f$の\emph{像}（\emph{値域}）という．

  \index{ぞう@像} \index{ちいき@値域}
\end{definition}

\begin{figure}[h]
  \centering
  \begin{tikzpicture}[scale=1]
    % Aの集合（薄い青色）
    \draw[fill=cyan!20, draw=cyan] (-5,0) ellipse (2.5cm and 3cm);
    \node at (-5,3.5) {$A$};

    % Bの集合（薄い赤色）
    \draw[fill=red!20, draw=red] (5,0) ellipse (2.5cm and 3cm);
    \node at (5,3.5) {$B$};

    % Aの要素
    \fill (-5,1) circle (2pt);
    \node[left] at (-5,1) {$1$};

    \fill (-5,0) circle (2pt);
    \node[left] at (-5,0) {$2$};

    \fill (-5,-1) circle (2pt);
    \node[left] at (-5,-1) {$3$};

    % Bの要素
    \fill (5,0.5) circle (2pt);
    \node[right] at (5,0.5) {$a$};

    \fill (5,-0.5) circle (2pt);
    \node[right] at (5,-0.5) {$b$};


    % 矢印（写像）
    \draw[->, thin] (-5,1) to[bend left=20] (5,0.5); % 1をaに対応
    \draw[->, thin] (-5,0) to[bend left=0] (5,-0.5); % 2をbに対応
    \draw[->, thin] (-5,-1) to[bend left=20] (5,0.5); % 3をaに対応

    % A'の集合（濃い青色）
    \draw[fill=blue!50, opacity=0.5] (-5,0) ellipse (1.0cm and 1.7cm);
    \node at (-6.5,0.5) {$A'$};

    % 像 f(A')（濃い赤色）
    \draw[fill=red!50, opacity=0.5] (5,0) ellipse (0.7cm and 1.1cm);
    \node at (6.5,0.5) {$f(A')$};
  \end{tikzpicture}
  \caption{像}
\end{figure}


\begin{definition}{逆像}{逆像}
  写像$f \colon A \to B$と集合$B' \subset B$に対して，$B'$の\emph{逆像}とは，
  \[
    f^{-1}(B') = \{ a \in A \mid f(a) \in B' \}
  \]
  で定義される集合である．

  \index{ぎゃくぞう@逆像}
\end{definition}

\begin{mycolumn}
  \deref{逆像}て定義した逆像は「写像」ではなく，あくまで「集合」であることに注意したい．
  逆像と紛らわしい単語に「逆写像」があるが，逆写像は$f$が全単射であるときに定義される写像である．その一方で，逆像は$f$が全単射でなくても定義される．
\end{mycolumn}


\begin{figure}[h]
  \centering
  \begin{tikzpicture}[scale=1]
    % 集合 A の描画（薄い青色）
    \draw[fill=cyan!20, draw=cyan] (-5,0) ellipse (2.5cm and 3cm);
    \node at (-5,3.5) {$A$};

    % 集合 B の描画（薄い赤色）
    \draw[fill=red!20, draw=red] (5,0) ellipse (2.5cm and 3cm);
    \node at (5,3.5) {$B$};

    % A の要素
    \fill (-5,1.5) circle (2pt);
    \node[left] at (-5,1.5) {$1$};

    \fill (-5,0.5) circle (2pt);
    \node[left] at (-5,0.5) {$2$};

    \fill (-5,-0.5) circle (2pt);
    \node[left] at (-5,-0.5) {$3$};

    \fill (-5,-1.5) circle (2pt);
    \node[left] at (-5,-1.5) {$4$};

    % B の要素
    \fill (5,0.5) circle (2pt);
    \node[right] at (5,0.5) {$a$};

    \fill (5,-0.5) circle (2pt);
    \node[right] at (5,-0.5) {$b$};

    % 矢印（写像 f）
    \draw[->, thin] (-5,1.5) to[bend left=20] (5,0.5); % 1 を a に対応
    \draw[->, thin] (-5,0.5) to[bend left=0] (5,0.5);   % 2 を a に対応
    \draw[->, thin] (-5,-0.5) to[bend right=20] (5,-0.5);% 3 を b に対応
    \draw[->, thin] (-5,-1.5) to[bend left=0] (5,0.5);% 4 を a に対応

    % B' の集合（濃い赤色）
    \draw[fill=red!50, opacity=0.5] (5,0) ellipse (0.5cm and 1.0cm);
    \node at (6.5,0.5) {$B'$};

    % f^{-1}(B') の集合（濃い青色）
    \draw[fill=cyan!50, opacity=0.5] (-5,0) ellipse (0.8cm and 2cm);
    \node at (-6.5,0.5) {$f^{-1}(B')$};
  \end{tikzpicture}
  \caption{逆像}
\end{figure}



\subsubsection{単射\index{たんしゃ@単射}}

\begin{definition}{単射}{単射}
  写像$f$が$A$から$B$への単射であるとは，異なる要素$a_1, a_2 \in A$に対して，$f(a_1) \ne f(a_2)$が成り立つことである\footnote{この条件は，先の定義の対偶を考えると「$f(a_1) =f(a_2)$ならば$a_1=a_2$が成り立つ」とも言い換えられる．}．
\end{definition}

集合 $A = \{1, 2, 3\}$，$B = \{a, b, c, d\}$ を考え，写像 $f$ を以下のように定義する．
\[
  f(1) = a, \quad f(2) = b, \quad f(3) = c.
\]

\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    % Aの集合
    \draw[fill=cyan!20, draw=cyan] (-2,0) ellipse (1.5cm and 2cm);
    \node at (-2,2.2) {$A$};

    % Bの集合
    \draw[fill=cyan!20, draw=cyan] (3,0) ellipse (1.5cm and 2cm);
    \node at (3,2.2) {$B$};

    % Aの要素
    \fill (-2,1) circle (2pt);
    \node[left] at (-2,1) {$1$};

    \fill (-2,0) circle (2pt);
    \node[left] at (-2,0) {$2$};

    \fill (-2,-1) circle (2pt);
    \node[left] at (-2,-1) {$3$};

    % Bの要素
    \fill (3,1.5) circle (2pt);
    \node[right] at (3,1.5) {$a$};

    \fill (3,0.5) circle (2pt);
    \node[right] at (3,0.5) {$b$};

    \fill (3,-0.5) circle (2pt);
    \node[right] at (3,-0.5) {$c$};

    \fill (3,-1.5) circle (2pt);
    \node[right] at (3,-1.5) {$d$};

    % 矢印（写像）
    \draw[->, thin] (-2,1) to[bend left=20] (3,1.5); % 1をaに対応
    \draw[->, thin] (-2,0) to[bend left=10] (3,0.5); % 2をbに対応
    \draw[->, thin] (-2,-1) to[bend right=0] (3,-0.5); % 3をcに対応
  \end{tikzpicture}
  \caption{単射の例}
\end{figure}

この$f$は単射だが，全射でない．

\begin{example}{電話番号と電話機}{電話番号と電話機}
  現代では，各電話番号は特定の電話機に対応している．この対応関係を写像として考えてみよう．

  集合$A$を電話番号の集合，集合$B$を実際の電話機の集合とする．
  また，電話番号 $a \in A$ に対して，$f$という規則で対応する電話機を $b \in B$ とする．

  このとき，
  \[
    b = f(a)
  \]
  とかくと，$f$ は写像の定義を満たす．

  また，現代では各電話番号が唯一の電話機に割り当てられることが多いため，異なる電話番号が同じ電話機を指し示すことはない．

  例えば，$A = \{\text{090-1234-5678}, \text{080-9876-5432}, \text{070-1111-2222}\}$，
  $B = \{\text{Phone1}, \text{Phone2}, \text{Phone3}\}$ とし，写像 $f$ を次のように定義する．
  \[
    f(\text{090-1234-5678}) = \text{Phone1}, \quad
    f(\text{080-9876-5432}) = \text{Phone2}, \quad
    f(\text{070-1111-2222}) = \text{Phone3}.
  \]

  このとき，$f$は単射である．
\end{example}

\subsubsection{全射\index{ぜんしゃ@全射}}

\begin{definition}{全射}{全射}
  写像$f$が$A$から$B$への全射であるとは，任意の$b \in B$に対して，ある$a \in A$が存在して，$f(a) = b$が成り立つことである．
\end{definition}

集合 $A = \{1, 2, 3\}$，$B = \{a, b\}$ を考え，写像 $f$ を以下のように定義する．
\[
  f(1) = a, \quad f(2) = a, \quad f(3) = b.
\]

\begin{figure}[h]
  \centering
  \begin{tikzpicture}
    % Aの集合
    \draw[fill=cyan!20, draw=cyan] (-2,0) ellipse (1.5cm and 2cm);
    \node at (-2,2.2) {$A$};

    % Bの集合
    \draw[fill=cyan!20, draw=cyan] (3,0) ellipse (1.5cm and 2cm);
    \node at (3,2.2) {$B$};

    % Aの要素
    \fill (-2,1) circle (2pt);
    \node[left] at (-2,1) {$1$};

    \fill (-2,0) circle (2pt);
    \node[left] at (-2,0) {$2$};

    \fill (-2,-1) circle (2pt);
    \node[left] at (-2,-1) {$3$};

    % Bの要素
    \fill (3,0.5) circle (2pt);
    \node[right] at (3,0.5) {$a$};

    \fill (3,-0.5) circle (2pt);
    \node[right] at (3,-0.5) {$b$};

    % 矢印（写像）
    \draw[->, thin] (-2,1) to[bend left=20] (3,0.5); % 1をaに対応
    \draw[->, thin] (-2,0) to[bend left=10] (3,0.5); % 2をaに対応
    \draw[->, thin] (-2,-1) to[bend right=0] (3,-0.5); % 3をbに対応
  \end{tikzpicture}
  \caption{全射の例}
\end{figure}

この$f$は全射だが，単射でない．

\begin{example}{分類コードと本}{分類コードと本}
  公共図書館では，各本に分類コードが割り当てられており，本を分類している．この対応関係を写像として考えてみよう．

  集合$A$を図書館にある本の集合，集合$B$を使用されている分類コードの集合とする．
  また，本 $a \in A$ に対して，分類コード $b \in B$ を割り当てる規則$f$を定める．

  このとき，
  \[
    b = f(a)
  \]
  と書くと，$f$ は写像の定義を満たす．

  図書館では，複数の本が同じ分類コードを持つことが一般的である、つまり，異なる本が同じ分類コードに対応することがある．

  例えば，$A = \{\text{『数学入門』}, \text{『微分積分』}, \text{『物理学基礎』}, \text{『統計学』}\}$，
  $B = \{\text{410}, \text{420}, \text{350}\}$ とし，写像 $f$ を次のように定義する．
  \[
    f(\text{『数学入門』}) = 410, \quad
    f(\text{『微分積分』}) = 410, \quad
    f(\text{『物理学基礎』}) = 420, \quad
    f(\text{『統計学』}) = 350.
  \]

  このとき，$f$は全射である．なぜなら，$B$の要素である410, 420, 350は全て$A$の要素によってカバーされているからである．しかし，$f$は単射ではない．なぜなら，$\text{『数学入門』}$と$\text{『微分積分』}$がともに410に対応しており，異なる本が同じ分類コードに対応しているからである．

\end{example}


\subsubsection{全単射\index{ぜんたんしゃ@全単射}}

\begin{definition}{全単射}{全単射}
  写像$f$が$A$から$B$への全単射であるとは，$f$が単射かつ全射となることである．
\end{definition}

集合 $A = \{1, 2, 3\}$，$B = \{a, b, c\}$ を考え，写像 $f$ を以下のように定義する．
\[
  f(1) = c, \quad f(2) = b, \quad f(3) = a.
\]

\begin{figure}[ht]
  \centering
  \begin{tikzpicture}
    % Aの集合
    \draw[fill=cyan!20, draw=cyan] (-2,0) ellipse (1.5cm and 2cm);
    \node at (-2,2.2) {$A$};

    % Bの集合
    \draw[fill=cyan!20, draw=cyan] (3,0) ellipse (1.5cm and 2cm);
    \node at (3,2.2) {$B$};

    % Aの要素
    \fill (-2,1) circle (2pt);
    \node[left] at (-2,1) {$1$};

    \fill (-2,0) circle (2pt);
    \node[left] at (-2,0) {$2$};

    \fill (-2,-1) circle (2pt);
    \node[left] at (-2,-1) {$3$};

    % Bの要素
    \fill (3,1) circle (2pt);
    \node[right] at (3,1) {$a$};

    \fill (3,0) circle (2pt);
    \node[right] at (3,0) {$b$};

    \fill (3,-1) circle (2pt);
    \node[right] at (3,-1) {$c$};
    ¬
    % 矢印（写像）
    \draw[->, thin] (-2,1) to[bend left=20] (3,-1); % 1をaに対応
    \draw[->, thin] (-2,0) to[bend left=0] (3,0); % 2をbに対応
    \draw[->, thin] (-2,-1) to[bend right=20] (3,1); % 3をcに対応
  \end{tikzpicture}
  \caption{全単射の例}
\end{figure}

この $f$ は単射かつ全射，すなわち全単射である．

\begin{example}{学籍番号と学生}{学籍番号と学生}
  あるクラスの学生とその学籍番号の対応を考える．
  集合 $A$ を学生の集合，集合 $B$ を学籍番号の集合とする．
  ここでは，
  \[
    A = \{\text{Alice}, \text{Bob}, \text{Charlie}\}, \quad
    B = \{\text{2024001}, \text{2024002}, \text{2024003}\}.
  \]
  とする．

  そして，学生 $a \in A$ に対して学籍番号 $b \in B$ を一意的に割り当てる規則 $f$ を次のように定義する．
  \[
    f(\text{Alice}) = \text{2024001}, \quad
    f(\text{Bob}) = \text{2024002}, \quad
    f(\text{Charlie}) = \text{2024003}.
  \]

  この写像 $f$ は$f$ は単射かつ全射，すなわち全単射である．
\end{example}

\begin{example}{単射・全射・全単射}{単射・全射・全単射}
  \begin{enumerate}[(A)]
    \item
          \[
            f \colon [0,\infty) \ni x \mapsto x^2  \in \mathbb{R}
          \]
          は単射であるが全射でない．
    \item
          \[
            g \colon \mathbb{R} \ni x \mapsto x^3 -3x^2 -9 \in \mathbb{R}
          \]
          は全射であるが単射でない．
    \item
          \[
            h  \colon \mathbb{R} \ni x \mapsto  2 \sin x \in  \mathbb{R}
          \]
          は全射でも単射でもない．しかし，
          \[
            h'  \colon [-\pi/2 , \pi/2 ]  \ni x \mapsto  2 \sin  x  \in [-2,2]
          \]
          は全単射である．
  \end{enumerate}
\end{example}
\clearpage

\cite{nakajima}，\cite{kaneko}，\cite{arai}を参考にした．

% 参考文献
\phantomsection
\setcounter{section}{5}
\titleformat{name=\section,numberless}[block]
{}{}{0pt}{\normalfont\huge\bfseries}
\printbibliography[title=参考文献]
\addcontentsline{toc}{section}{参考文献}

% 索引
\clearpage
\setcounter{section}{6}
\renewcommand{\indexname}{索引}
\titleformat{name=\section,numberless}[block]
{}{}{0pt}{\normalfont\huge\bfseries}
\phantomsection \addcontentsline{toc}{section}{索引}
\printindex

\end{document}